"use strict";(()=>{var e={};e.id=5994,e.ids=[5994],e.modules={30421:e=>{e.exports=require("google-spreadsheet")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},56249:(e,r)=>{Object.defineProperty(r,"l",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},45578:(e,r,t)=>{t.r(r),t.d(r,{config:()=>m,default:()=>g,routeModule:()=>h});var n={};t.r(n),t.d(n,{default:()=>P});var s=t(71802),a=t(47153),o=t(56249),i=t(30421);let u=require("bowser");var c=t.n(u);let l=process.env.TUTORIAL_FEEDBACK_SHEET_ID,d=process.env.FEEDBACK_SERVICE_EMAIL,p=process.env.FEEDBACK_PRIVATE_KEY;async function f(){let e=p.replace(/\\n/g,"\n"),r=new i.GoogleSpreadsheet(l);return await r.useServiceAccountAuth({client_email:d,private_key:e}),await r.loadInfo(),r.sheetsByIndex[0]}async function E({body:e,headers:r}){let t=[];if(["sessionId","page","responses","timestamp"].forEach(r=>{e[r]||t.push(r)}),t.length>0){let e=Error(`The following required fields are missing: ${t}`);throw e.status=400,e}return e}async function A(e,r){let{sessionId:t}=r,n=await e.getRows(),s=null;return n.some((e,r)=>{if(e.sessionId===t)return s=r,!0}),!!s&&(Object.keys(r).forEach(e=>{n[s][e]=r[e]}),n[s])}let P=async(e,r)=>{try{let t=await E(e),n=await f(),{responses:s,sessionId:a,...o}=t,{helpful:i,...u}=s,{browser:l,os:d,platform:p}=c().parse(e.headers["user-agent"]),P={sessionId:a,helpful:i,...u,...o,browser:`${l.name} ${l.version}`,os:`${d.name} ${d.version}`,platform:p.type},g=await A(n,P);g?await g.save():await n.addRow({...P}),r.status(204).end()}catch(t){console.error("Error occurred. ",t);let e="An unexpected error occurred.";(t.response?.status===404||t.response?.status===400)&&(e=`An error occurred: ${t.message}`),r.status(t.response?.status||500).json({body:{error:e}})}},g=(0,o.l)(n,"default"),m=(0,o.l)(n,"config"),h=new s.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/tutorial-feedback",pathname:"/api/tutorial-feedback",bundlePath:"",filename:""},userland:n})},47153:(e,r)=>{var t;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(t||(t={}))},71802:(e,r,t)=>{e.exports=t(20145)}};var r=require("../../webpack-api-runtime.js");r.C(e);var t=r(r.s=45578);module.exports=t})();