{"pageProps":{"metadata":{"title":"Mondoo Provisioner | Integrations"},"product":{"name":"Packer","slug":"packer","algoliaConfig":{"indexName":"product_PACKER","searchOnlyApiKey":"4e1ea7f4bf4335ac43d9f28463e42148"},"analyticsConfig":{"includedDomains":"packer.io www.packer.io","segmentWriteKey":"AjXdfmTTk1I9q9dfyePuDFHBrz1tCO3l"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Packer by HashiCorp","description":"Packer helps you create golden images for multiple platforms from a single source configuration.","image":"https://www.packer.io/packer-public/img/og-image.png","icon":[{"href":"/packer-public/_favicon.ico"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiConf","url":"https://hashiconf.com/2023?utm_source=direct&utm_medium=banner&utm_campaign=23Q3_HASHICONFGLOBAL_EVENT&utm_content=&utm_offer=event","text":"Our community conference is taking place in San Francisco and online October 10-12.","linkText":"Register now","expirationDate":""},"version":"1.7.10","basePaths":["docs","guides","intro","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"guide","name":"Guides","path":"guides"}],"integrationsConfig":{"description":"A curated collection of official, partner, and community Packer Integrations."}},"integration":{"id":"273f8ca5-b148-4f86-8c8d-a57f6dc01714","slug":"cnspec","name":"Mondoo","description":"Scans Linux and Windows HashiCorp Packer builds for vulnerabilities and security misconfigurations.","license_type":null,"license_url":null,"external_only":false,"external_url":null,"tier":"partner","repo_url":"https://github.com/mondoohq/packer-plugin-cnspec","subdirectory":"/.web-docs","created_at":"2023-08-14T20:21:46.250Z","updated_at":"2024-01-26T15:26:17.953Z","hide_versions":false,"organization":{"id":"aad79811-5be6-4f2d-b847-9e5b19bba31f","slug":"mondoohq","created_at":"2023-08-14T20:21:46.131Z","updated_at":"2023-08-14T20:21:46.131Z"},"product":{"id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","slug":"packer","name":"Packer","created_at":"2022-11-09T22:56:29.896Z","updated_at":"2022-11-09T22:56:29.896Z"},"versions":["10.7.1","10.7.0","10.1.2","10.1.0","10.0.3","0.0.0"],"components":[{"id":"418417de-2c71-46a1-8dbc-7e9ae777a22e","slug":"provisioner","name":"Provisioner","plural_name":"Provisioners"},{"id":"418417de-2c71-46a1-8dbc-7e9ae777a22e","slug":"provisioner","name":"Provisioner","plural_name":"Provisioners"}],"flags":[],"integration_type":null},"activeRelease":{"id":"84d8b01f-1130-4181-a663-99185ce92a4c","integration_id":"273f8ca5-b148-4f86-8c8d-a57f6dc01714","version":"10.7.1","readme":"Packer plugin [cnspec](https://github.com/mondoohq/cnspec) by [Mondoo](https://mondoo.com) scans Linux and Windows [HashiCorp Packer](https://www.packer.io) builds for vulnerabilities and security misconfigurations. The plugin retrieves CVE data from Mondoo, which is updated daily with the latest CVEs and advisories. Additionally, cnspec runs security scans using [cnspec-policies](https://github.com/mondoohq/cnspec-policies) to uncover common misconfigurations that open your hosts to the risk of attack. cnspec supports scanning of Linux, Windows, and macOS, as well as Docker containers.\n\nPacker plugin cnspec is designed to work in one of two modes:\n\n- **Unregistered** - In unregistered mode, the plugin works without being registered to Mondoo Platform, and is designed to provide baseline security scanning with minimal configuration. The plugin runs either the [Linux Security by Mondoo](https://github.com/mondoohq/cnspec-policies/blob/main/core/mondoo-linux-security.mql.yaml) policy on Linux builds, or the [Windows Security by Mondoo](https://github.com/mondoohq/cnspec-policies/blob/main/core/mondoo-windows-security.mql.yaml) policy on Windows builds. Each of these policies provides security hardening checks based off of industry standards for Linux and Windows. Scan results are shown in STDOUT during the Packer run.\n- **Registered** - In registered mode, the plugin is registered to your account in Mondoo Platform using a service account. Registered mode allows you to configure and customize any of the policies in Mondoo Platform including CIS benchmarks and more. Scan results are shown in STDOUT and sent back to Mondoo Platform for your records.\n\n### Installation\n\nTo install this plugin, copy and paste this code into your Packer configuration, then run [`packer init`](https://www.packer.io/docs/commands/init).\n\n```hcl\npacker {\n  required_plugins {\n    cnspec = {\n      version = \">= 10.0.0\"\n      source  = \"github.com/mondoohq/cnspec\"\n    }\n  }\n}\n```\n\nAlternatively, you can use `packer plugins install` to manage installation of this plugin.\n\n```sh\n$ packer plugins install github.com/mondoohq/cnspec\n```\n\n### Components\n\n#### Provisioners\n\n- [cnspec](/packer/integrations/mondoohq/cnspec/latest/components/provisioner/cnspec) - Packer plugin [cnspec](https://github.com/mondoohq/cnspec) by [Mondoo](https://mondoo.com) scans \nLinux and Windows machine images for vulnerabilities and security misconfigurations. The plugin retrieves CVE data from Mondoo, which is updated daily with the latest CVEs and advisories. Additionally, cnspec runs security scans using [cnspec-policies](https://github.com/mondoohq/cnspec-policies) to uncover common misconfigurations that open your hosts to the risk of attack. \n- [mondoo](/packer/integrations/mondoohq/cnspec/latest/components/provisioner/mondoo) - The `mondoo` provisioner scans [Packer](https://www.packer.io) builds for vulnerabilities and misconfigurations by executing security\npolicies-as-code enabled in [Mondoo Platform](https://console.mondoo.com). Mondoo Platform comes stocked with an ever-increasing collection of\ncertified security policies which can be easily customize to meet your needs.\n\n### Tutorials\n\nCheck out the Packer tutorials on the Mondoo documentation site:\n\n- [Building secure AMIs with Mondoo and Packer](https://mondoo.com/docs/cnspec/cnspec-aws/cnspec-aws-packer/)\n- [Building secure VM images in Google Cloud with cnspec and HashiCorp Packer](https://mondoo.com/docs/cnspec/cnspec-gcp/cnspec-gcp-packer/)\n\n","created_at":"2024-03-13T13:46:29.967Z","updated_at":"2024-03-13T13:46:29.967Z","components":[{"id":"c589e1f0-7b02-4553-b995-beb7a9c75a04","integration_release_id":"84d8b01f-1130-4181-a663-99185ce92a4c","component_id":"418417de-2c71-46a1-8dbc-7e9ae777a22e","readme":"Type: `cnspec`\n\nPacker plugin [cnspec](https://github.com/mondoohq/cnspec) by [Mondoo](https://mondoo.com) scans Linux and Windows machine images for vulnerabilities and security misconfigurations. The plugin retrieves CVE data from Mondoo, which is updated daily with the latest CVEs and advisories. Additionally, cnspec runs security scans using [cnspec-policies](https://github.com/mondoohq/cnspec-policies) to uncover common misconfigurations that open your hosts to the risk of attack. \n\n## Basic Example\n```hcl\nprovisioner \"cnspec\" {\n  on_failure          = \"continue\"\n  score_threshold     = 85\n  sudo {\n    active = true\n  }\n}\n```\n\n## Configuration Reference\n\nOptional Parameters:\n<!-- Code generated from the comments of the Config struct in provisioner/provisioner.go; DO NOT EDIT MANUALLY -->\n\n- `host_alias` (string) - The alias by which the host should be known.\n  Defaults to `default`.\n\n- `user` (string) - The `user` set for your communicator. Defaults to the `user` set\n  by packer.\n\n- `local_port` (uint) - The port on which to attempt to listen for SSH\n   connections. This value is a starting point. The provisioner will attempt\n   listen for SSH connections on the first available of ten ports, starting at\n   `local_port`. A system-chosen port is used when `local_port` is missing or\n   empty.\n\n- `ssh_host_key_file` (string) - The SSH key that will be used to run the SSH\n   server on the host machine to forward commands to the target machine.\n   packer connects to this server and will validate the identity of the\n   server using the system known_hosts. The default behavior is to generate\n   and use a onetime key.\n\n- `ssh_authorized_key_file` (string) - The SSH public key of the packer `ssh_user`.\n  The default behavior is to generate and use a onetime key.\n\n- `use_sftp` (bool) - packer's SFTP proxy is not reliable on some unix/linux systems,\n  therefore we recommend to use scp as default for packer proxy\n\n- `debug` (bool) - Sets the log level to `DEBUG`\n\n- `asset_name` (string) - The asset name passed to Mondoo Platform. Defaults to the hostname\n  of the instance.\n\n- `on_failure` (string) - Configure behavior whether packer should fail if `scan_threshold` is\n  not met. If `scan_threshold` configuration is omitted, the threshold\n  is set to `0` and builds will pass regardless of what score is\n  returned.\n  If `score_threshold` is set to a value, and `on_failure = \"continue\"`\n  builds will continue regardless of what score is returned.\n\n- `labels` (map[string]string) - Configure an optional map of `key/val` labels for the asset in\n  Mondoo Platform.\n\n- `annotations` (map[string]string) - Configure an optional map of `key/val` annotations for the asset in\n  Mondoo Platform.\n\n- `incognito` (bool) - Configures incognito mode. By default it detects if a Mondoo service account\n  is available. When set to false, scan results will not be sent to\n  Mondoo Platform.\n\n- `policies` ([]string) - A list of policies to be executed (will automatically activate incognito mode).\n\n- `policybundle` (string) - A path to local policy bundle file.\n\n- `sudo` (\\*SudoConfig) - Runs scan with `--sudo`. Defaults to none.\n\n- `winrm_user` (string) - Configure WinRM user. Defaults to `user` set by the packer communicator.\n\n- `winrm_password` (string) - Configure WinRM user password. Defaults to `password` set by the packer\n  communicator.\n\n- `use_proxy` (bool) - Use proxy to connect to host to scan. This configuration will fall-back to\n  packer proxy for cases where the provisioner cannot access the target directly\n\n- `output` (string) - Set output format: compact, csv, full, json, junit, report, summary, yaml\n  (default \"compact\")\n\n- `output_target` (string) - Set output target. E.g. path to local file\n\n- `score_threshold` (int) - An integer value to set the `score_threshold` of mondoo scans. Defaults to\n  `0` which results in a passing score regardless of what scan results are\n  returned.\n\n- `mondoo_config_path` (string) - The path to the Mondoo's service account. Defaults to\n  `$HOME/.config/mondoo/mondoo.yml`\n\n<!-- End of code generated from the comments of the Config struct in provisioner/provisioner.go; -->\n\n\n### SudoConfig\n<!-- Code generated from the comments of the SudoConfig struct in provisioner/provisioner.go; DO NOT EDIT MANUALLY -->\n\n- `active` (bool) - Active\n\n<!-- End of code generated from the comments of the SudoConfig struct in provisioner/provisioner.go; -->\n\n\n## Get Started with cnspec\n\nIf you are new to cnspec, check out [Get started with cnspec](https://mondoo.com/docs/cnspec/).\n\n## Packer plugin cnspec tutorial\n\nCheck out the Packer tutorials on the Mondoo documentation site:\n\n- [Building secure AMIs with Mondoo and Packer](https://mondoo.com/docs/cnspec/cnspec-aws/cnspec-aws-packer/) \n- [Building secure VM images in Google Cloud with cnspec and HashiCorp Packer](https://mondoo.com/docs/cnspec/cnspec-gcp/cnspec-gcp-packer/) \n\n## Sample Packer Templates\n\nYou can find example Packer templates in the [examples](https://github.com/mondoohq/packer-plugin-cnspec/tree/main/examples) directory in this repository.\n","created_at":"2024-03-13T13:46:30.291Z","updated_at":"2024-03-13T13:46:30.291Z","name":"cnspec","slug":"cnspec","component":{"id":"418417de-2c71-46a1-8dbc-7e9ae777a22e","slug":"provisioner","name":"Provisioner","plural_name":"Provisioners","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.054Z","updated_at":"2022-11-09T22:56:31.054Z"},"variable_groups":[]},{"id":"9a40c937-3106-4c59-b8fa-a6dd7dbb10c5","integration_release_id":"84d8b01f-1130-4181-a663-99185ce92a4c","component_id":"418417de-2c71-46a1-8dbc-7e9ae777a22e","readme":"Type: `mondoo`\n\n>This plugin has been deprecated. Migrate to [Packer plugin cnspec by Mondoo](https://developer.hashicorp.com/packer/plugins/provisioner/mondoo/cnspec) for even easier security scanning of your Packer builds.\n\nThe `mondoo` provisioner scans [Packer](https://www.packer.io) builds for vulnerabilities and misconfigurations by executing security\npolicies-as-code enabled in [Mondoo Platform](https://console.mondoo.com). Mondoo Platform comes stocked with an ever-increasing collection of\ncertified security policies which can be easily customize to meet your needs.\n\nMondoo supports scanning of Linux, Windows, and macOS, as well as Docker containers.\n\n## Basic Example\n```hcl\n  provisioner \"mondoo\" {\n    on_failure          = \"continue\"\n    mondoo_config_path  = \"/etc/mondoo-config.json\"\n    score_threshold     = 85\n    asset_name          = \"example-secure-base-image\"\n    sudo {\n      active = true\n    }\n\n    annotations = {\n      Source_AMI    = \"{{ .SourceAMI }}\"\n      Creation_Date = \"{{ .SourceAMICreationDate }}\"\n    }\n  }\n}\n```\n\n## Configuration Reference\n\nOptional Parameters:\n<!-- Code generated from the comments of the Config struct in provisioner/provisioner.go; DO NOT EDIT MANUALLY -->\n\n- `host_alias` (string) - The alias by which the host should be known.\n  Defaults to `default`.\n\n- `user` (string) - The `user` set for your communicator. Defaults to the `user` set\n  by packer.\n\n- `local_port` (uint) - The port on which to attempt to listen for SSH\n   connections. This value is a starting point. The provisioner will attempt\n   listen for SSH connections on the first available of ten ports, starting at\n   `local_port`. A system-chosen port is used when `local_port` is missing or\n   empty.\n\n- `ssh_host_key_file` (string) - The SSH key that will be used to run the SSH\n   server on the host machine to forward commands to the target machine.\n   packer connects to this server and will validate the identity of the\n   server using the system known_hosts. The default behavior is to generate\n   and use a onetime key.\n\n- `ssh_authorized_key_file` (string) - The SSH public key of the packer `ssh_user`.\n  The default behavior is to generate and use a onetime key.\n\n- `use_sftp` (bool) - packer's SFTP proxy is not reliable on some unix/linux systems,\n  therefore we recommend to use scp as default for packer proxy\n\n- `debug` (bool) - Sets the log level to `DEBUG`\n\n- `asset_name` (string) - The asset name passed to Mondoo Platform. Defaults to the hostname\n  of the instance.\n\n- `on_failure` (string) - Configure behavior whether packer should fail if `scan_threshold` is\n  not met. If `scan_threshold` configuration is omitted, the threshold\n  is set to `0` and builds will pass regardless of what score is\n  returned.\n  If `score_threshold` is set to a value, and `on_failure = \"continue\"`\n  builds will continue regardless of what score is returned.\n\n- `labels` (map[string]string) - Configure an optional map of `key/val` labels for the asset in\n  Mondoo Platform.\n\n- `annotations` (map[string]string) - Configure an optional map of `key/val` annotations for the asset in\n  Mondoo Platform.\n\n- `incognito` (bool) - Configures incognito mode. By default it detects if a Mondoo service account\n  is available. When set to false, scan results will not be sent to\n  Mondoo Platform.\n\n- `policies` ([]string) - A list of policies to be executed (will automatically activate incognito mode).\n\n- `policybundle` (string) - A path to local policy bundle file.\n\n- `sudo` (\\*SudoConfig) - Runs scan with `--sudo`. Defaults to none.\n\n- `winrm_user` (string) - Configure WinRM user. Defaults to `user` set by the packer communicator.\n\n- `winrm_password` (string) - Configure WinRM user password. Defaults to `password` set by the packer\n  communicator.\n\n- `use_proxy` (bool) - Use proxy to connect to host to scan. This configuration will fall-back to\n  packer proxy for cases where the provisioner cannot access the target directly\n\n- `output` (string) - Set output format: compact, csv, full, json, junit, report, summary, yaml\n  (default \"compact\")\n\n- `output_target` (string) - Set output target. E.g. path to local file\n\n- `score_threshold` (int) - An integer value to set the `score_threshold` of mondoo scans. Defaults to\n  `0` which results in a passing score regardless of what scan results are\n  returned.\n\n- `mondoo_config_path` (string) - The path to the Mondoo's service account. Defaults to\n  `$HOME/.config/mondoo/mondoo.yml`\n\n<!-- End of code generated from the comments of the Config struct in provisioner/provisioner.go; -->\n\n\n### SudoConfig\n<!-- Code generated from the comments of the SudoConfig struct in provisioner/provisioner.go; DO NOT EDIT MANUALLY -->\n\n- `active` (bool) - Active\n\n<!-- End of code generated from the comments of the SudoConfig struct in provisioner/provisioner.go; -->\n\n\n## Get Started with Mondoo\n\nIf you are new to Mondoo you can get started by [signing up for a free account](https://mondoo.com/docs/tutorials/mondoo/account-setup/) today!\n\nCheck out the Packer tutorials on the Mondoo documentation site:\n\n- [Building secure AMIs with Mondoo and Packer](https://mondoo.com/docs/cnspec/cnspec-aws/cnspec-aws-packer/) \n- [Building secure VM images in Google Cloud with cnspec and HashiCorp Packer](https://mondoo.com/docs/cnspec/cnspec-gcp/cnspec-gcp-packer/) \n\n## Sample Packer Templates\n\nYou can find example Packer templates in the [examples](https://github.com/mondoohq/packer-plugin-cnspec/tree/main/examples) directory in this repository.\n","created_at":"2024-03-13T13:46:30.227Z","updated_at":"2024-03-13T13:46:30.227Z","name":"Mondoo","slug":"mondoo","component":{"id":"418417de-2c71-46a1-8dbc-7e9ae777a22e","slug":"provisioner","name":"Provisioner","plural_name":"Provisioners","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.054Z","updated_at":"2022-11-09T22:56:31.054Z"},"variable_groups":[]}]},"component":{"id":"c589e1f0-7b02-4553-b995-beb7a9c75a04","integration_release_id":"84d8b01f-1130-4181-a663-99185ce92a4c","component_id":"418417de-2c71-46a1-8dbc-7e9ae777a22e","readme":"Type: `cnspec`\n\nPacker plugin [cnspec](https://github.com/mondoohq/cnspec) by [Mondoo](https://mondoo.com) scans Linux and Windows machine images for vulnerabilities and security misconfigurations. The plugin retrieves CVE data from Mondoo, which is updated daily with the latest CVEs and advisories. Additionally, cnspec runs security scans using [cnspec-policies](https://github.com/mondoohq/cnspec-policies) to uncover common misconfigurations that open your hosts to the risk of attack. \n\n## Basic Example\n```hcl\nprovisioner \"cnspec\" {\n  on_failure          = \"continue\"\n  score_threshold     = 85\n  sudo {\n    active = true\n  }\n}\n```\n\n## Configuration Reference\n\nOptional Parameters:\n<!-- Code generated from the comments of the Config struct in provisioner/provisioner.go; DO NOT EDIT MANUALLY -->\n\n- `host_alias` (string) - The alias by which the host should be known.\n  Defaults to `default`.\n\n- `user` (string) - The `user` set for your communicator. Defaults to the `user` set\n  by packer.\n\n- `local_port` (uint) - The port on which to attempt to listen for SSH\n   connections. This value is a starting point. The provisioner will attempt\n   listen for SSH connections on the first available of ten ports, starting at\n   `local_port`. A system-chosen port is used when `local_port` is missing or\n   empty.\n\n- `ssh_host_key_file` (string) - The SSH key that will be used to run the SSH\n   server on the host machine to forward commands to the target machine.\n   packer connects to this server and will validate the identity of the\n   server using the system known_hosts. The default behavior is to generate\n   and use a onetime key.\n\n- `ssh_authorized_key_file` (string) - The SSH public key of the packer `ssh_user`.\n  The default behavior is to generate and use a onetime key.\n\n- `use_sftp` (bool) - packer's SFTP proxy is not reliable on some unix/linux systems,\n  therefore we recommend to use scp as default for packer proxy\n\n- `debug` (bool) - Sets the log level to `DEBUG`\n\n- `asset_name` (string) - The asset name passed to Mondoo Platform. Defaults to the hostname\n  of the instance.\n\n- `on_failure` (string) - Configure behavior whether packer should fail if `scan_threshold` is\n  not met. If `scan_threshold` configuration is omitted, the threshold\n  is set to `0` and builds will pass regardless of what score is\n  returned.\n  If `score_threshold` is set to a value, and `on_failure = \"continue\"`\n  builds will continue regardless of what score is returned.\n\n- `labels` (map[string]string) - Configure an optional map of `key/val` labels for the asset in\n  Mondoo Platform.\n\n- `annotations` (map[string]string) - Configure an optional map of `key/val` annotations for the asset in\n  Mondoo Platform.\n\n- `incognito` (bool) - Configures incognito mode. By default it detects if a Mondoo service account\n  is available. When set to false, scan results will not be sent to\n  Mondoo Platform.\n\n- `policies` ([]string) - A list of policies to be executed (will automatically activate incognito mode).\n\n- `policybundle` (string) - A path to local policy bundle file.\n\n- `sudo` (\\*SudoConfig) - Runs scan with `--sudo`. Defaults to none.\n\n- `winrm_user` (string) - Configure WinRM user. Defaults to `user` set by the packer communicator.\n\n- `winrm_password` (string) - Configure WinRM user password. Defaults to `password` set by the packer\n  communicator.\n\n- `use_proxy` (bool) - Use proxy to connect to host to scan. This configuration will fall-back to\n  packer proxy for cases where the provisioner cannot access the target directly\n\n- `output` (string) - Set output format: compact, csv, full, json, junit, report, summary, yaml\n  (default \"compact\")\n\n- `output_target` (string) - Set output target. E.g. path to local file\n\n- `score_threshold` (int) - An integer value to set the `score_threshold` of mondoo scans. Defaults to\n  `0` which results in a passing score regardless of what scan results are\n  returned.\n\n- `mondoo_config_path` (string) - The path to the Mondoo's service account. Defaults to\n  `$HOME/.config/mondoo/mondoo.yml`\n\n<!-- End of code generated from the comments of the Config struct in provisioner/provisioner.go; -->\n\n\n### SudoConfig\n<!-- Code generated from the comments of the SudoConfig struct in provisioner/provisioner.go; DO NOT EDIT MANUALLY -->\n\n- `active` (bool) - Active\n\n<!-- End of code generated from the comments of the SudoConfig struct in provisioner/provisioner.go; -->\n\n\n## Get Started with cnspec\n\nIf you are new to cnspec, check out [Get started with cnspec](https://mondoo.com/docs/cnspec/).\n\n## Packer plugin cnspec tutorial\n\nCheck out the Packer tutorials on the Mondoo documentation site:\n\n- [Building secure AMIs with Mondoo and Packer](https://mondoo.com/docs/cnspec/cnspec-aws/cnspec-aws-packer/) \n- [Building secure VM images in Google Cloud with cnspec and HashiCorp Packer](https://mondoo.com/docs/cnspec/cnspec-gcp/cnspec-gcp-packer/) \n\n## Sample Packer Templates\n\nYou can find example Packer templates in the [examples](https://github.com/mondoohq/packer-plugin-cnspec/tree/main/examples) directory in this repository.\n","created_at":"2024-03-13T13:46:30.291Z","updated_at":"2024-03-13T13:46:30.291Z","name":"cnspec","slug":"cnspec","component":{"id":"418417de-2c71-46a1-8dbc-7e9ae777a22e","slug":"provisioner","name":"Provisioner","plural_name":"Provisioners","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.054Z","updated_at":"2022-11-09T22:56:31.054Z"},"variable_groups":[]},"processedVariablesMarkdown":{},"anchorLinks":[{"id":"basic-example","level":2,"title":"Basic Example"},{"id":"configuration-reference","level":2,"title":"Configuration Reference"},{"id":"sudoconfig","level":3,"title":"SudoConfig"},{"id":"get-started-with-cnspec","level":2,"title":"Get Started with cnspec"},{"id":"packer-plugin-cnspec-tutorial","level":2,"title":"Packer plugin cnspec tutorial"},{"id":"sample-packer-templates","level":2,"title":"Sample Packer Templates"}],"serializedREADME":{"compiledSource":"var m=Object.defineProperty,d=Object.defineProperties;var u=Object.getOwnPropertyDescriptors;var i=Object.getOwnPropertySymbols;var l=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;var p=(n,a,t)=>a in n?m(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t,e=(n,a)=>{for(var t in a||(a={}))l.call(a,t)&&p(n,t,a[t]);if(i)for(var t of i(a))s.call(a,t)&&p(n,t,a[t]);return n},r=(n,a)=>d(n,u(a));var c=(n,a)=>{var t={};for(var o in n)l.call(n,o)&&a.indexOf(o)<0&&(t[o]=n[o]);if(n!=null&&i)for(var o of i(n))a.indexOf(o)<0&&s.call(n,o)&&(t[o]=n[o]);return t};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var o=t,{components:n}=o,a=c(o,[\"components\"]);return mdx(MDXLayout,r(e(e({},layoutProps),a),{components:n,mdxType:\"MDXLayout\"}),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Type: \",mdx(\"inlineCode\",{parentName:\"p\"},\"cnspec\")),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Packer plugin \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://github.com/mondoohq/cnspec\"}),\"cnspec\"),\" by \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://mondoo.com\"}),\"Mondoo\"),\" scans Linux and Windows machine images for vulnerabilities and security misconfigurations. The plugin retrieves CVE data from Mondoo, which is updated daily with the latest CVEs and advisories. Additionally, cnspec runs security scans using \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://github.com/mondoohq/cnspec-policies\"}),\"cnspec-policies\"),\" to uncover common misconfigurations that open your hosts to the risk of attack. \"),mdx(\"h2\",e({},{id:\"user-content-basic-example\",\"data-text-content\":\"Basic Example\",className:\"g-type-display-3\"}),\"Basic Example\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"provisioner\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"cnspec\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"on_failure\"),\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"continue\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"score_threshold\"),\"     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"85\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"sudo\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"active\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean\"}),\"true\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h2\",e({},{id:\"user-content-configuration-reference\",\"data-text-content\":\"Configuration Reference\",className:\"g-type-display-3\"}),\"Configuration Reference\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Optional Parameters:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"host_alias\"),` (string) - The alias by which the host should be known.\nDefaults to `,mdx(\"inlineCode\",{parentName:\"p\"},\"default\"),\".\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"user\"),\" (string) - The \",mdx(\"inlineCode\",{parentName:\"p\"},\"user\"),\" set for your communicator. Defaults to the \",mdx(\"inlineCode\",{parentName:\"p\"},\"user\"),` set\nby packer.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"local_port\"),` (uint) - The port on which to attempt to listen for SSH\nconnections. This value is a starting point. The provisioner will attempt\nlisten for SSH connections on the first available of ten ports, starting at\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"local_port\"),\". A system-chosen port is used when \",mdx(\"inlineCode\",{parentName:\"p\"},\"local_port\"),` is missing or\nempty.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"ssh_host_key_file\"),` (string) - The SSH key that will be used to run the SSH\nserver on the host machine to forward commands to the target machine.\npacker connects to this server and will validate the identity of the\nserver using the system known_hosts. The default behavior is to generate\nand use a onetime key.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"ssh_authorized_key_file\"),\" (string) - The SSH public key of the packer \",mdx(\"inlineCode\",{parentName:\"p\"},\"ssh_user\"),`.\nThe default behavior is to generate and use a onetime key.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"use_sftp\"),` (bool) - packer's SFTP proxy is not reliable on some unix/linux systems,\ntherefore we recommend to use scp as default for packer proxy`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"debug\"),\" (bool) - Sets the log level to \",mdx(\"inlineCode\",{parentName:\"p\"},\"DEBUG\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"asset_name\"),` (string) - The asset name passed to Mondoo Platform. Defaults to the hostname\nof the instance.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"on_failure\"),\" (string) - Configure behavior whether packer should fail if \",mdx(\"inlineCode\",{parentName:\"p\"},\"scan_threshold\"),` is\nnot met. If `,mdx(\"inlineCode\",{parentName:\"p\"},\"scan_threshold\"),` configuration is omitted, the threshold\nis set to `,mdx(\"inlineCode\",{parentName:\"p\"},\"0\"),` and builds will pass regardless of what score is\nreturned.\nIf `,mdx(\"inlineCode\",{parentName:\"p\"},\"score_threshold\"),\" is set to a value, and \",mdx(\"inlineCode\",{parentName:\"p\"},'on_failure = \"continue\"'),`\nbuilds will continue regardless of what score is returned.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"labels\"),\" (map\",\"[string]\",\"string) - Configure an optional map of \",mdx(\"inlineCode\",{parentName:\"p\"},\"key/val\"),` labels for the asset in\nMondoo Platform.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"annotations\"),\" (map\",\"[string]\",\"string) - Configure an optional map of \",mdx(\"inlineCode\",{parentName:\"p\"},\"key/val\"),` annotations for the asset in\nMondoo Platform.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"incognito\"),` (bool) - Configures incognito mode. By default it detects if a Mondoo service account\nis available. When set to false, scan results will not be sent to\nMondoo Platform.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"policies\"),\" ([]string) - A list of policies to be executed (will automatically activate incognito mode).\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"policybundle\"),\" (string) - A path to local policy bundle file.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"sudo\"),\" (\",\"*\",\"SudoConfig) - Runs scan with \",mdx(\"inlineCode\",{parentName:\"p\"},\"--sudo\"),\". Defaults to none.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"winrm_user\"),\" (string) - Configure WinRM user. Defaults to \",mdx(\"inlineCode\",{parentName:\"p\"},\"user\"),\" set by the packer communicator.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"winrm_password\"),\" (string) - Configure WinRM user password. Defaults to \",mdx(\"inlineCode\",{parentName:\"p\"},\"password\"),` set by the packer\ncommunicator.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"use_proxy\"),` (bool) - Use proxy to connect to host to scan. This configuration will fall-back to\npacker proxy for cases where the provisioner cannot access the target directly`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"output\"),` (string) - Set output format: compact, csv, full, json, junit, report, summary, yaml\n(default \"compact\")`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"output_target\"),\" (string) - Set output target. E.g. path to local file\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"score_threshold\"),\" (int) - An integer value to set the \",mdx(\"inlineCode\",{parentName:\"p\"},\"score_threshold\"),` of mondoo scans. Defaults to\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"0\"),` which results in a passing score regardless of what scan results are\nreturned.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"mondoo_config_path\"),` (string) - The path to the Mondoo's service account. Defaults to\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"$HOME/.config/mondoo/mondoo.yml\")))),mdx(\"h3\",e({},{id:\"user-content-sudoconfig\",\"data-text-content\":\"SudoConfig\",className:\"g-type-display-4\"}),\"SudoConfig\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"active\"),\" (bool) - Active\")),mdx(\"h2\",e({},{id:\"user-content-get-started-with-cnspec\",\"data-text-content\":\"Get Started with cnspec\",className:\"g-type-display-3\"}),\"Get Started with cnspec\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"If you are new to cnspec, check out \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://mondoo.com/docs/cnspec/\"}),\"Get started with cnspec\"),\".\"),mdx(\"h2\",e({},{id:\"user-content-packer-plugin-cnspec-tutorial\",\"data-text-content\":\"Packer plugin cnspec tutorial\",className:\"g-type-display-3\"}),\"Packer plugin cnspec tutorial\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Check out the Packer tutorials on the Mondoo documentation site:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"https://mondoo.com/docs/cnspec/cnspec-aws/cnspec-aws-packer/\"}),\"Building secure AMIs with Mondoo and Packer\"),\" \"),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"https://mondoo.com/docs/cnspec/cnspec-gcp/cnspec-gcp-packer/\"}),\"Building secure VM images in Google Cloud with cnspec and HashiCorp Packer\"),\" \")),mdx(\"h2\",e({},{id:\"user-content-sample-packer-templates\",\"data-text-content\":\"Sample Packer Templates\",className:\"g-type-display-3\"}),\"Sample Packer Templates\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"You can find example Packer templates in the \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://github.com/mondoohq/packer-plugin-cnspec/tree/main/examples\"}),\"examples\"),\" directory in this repository.\"))}MDXContent.isMDXComponent=!0;\n","scope":{}},"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Packer","url":"/packer"},{"title":"Integrations","url":"/packer/integrations"},{"title":"Mondoo","url":"/packer/integrations/mondoohq/cnspec","isCurrentPage":false},{"title":"v10.7.1","url":"/packer/integrations/mondoohq/cnspec/v10.7.1","isCurrentPage":false},{"title":"Components"},{"title":"Provisioner"},{"title":"cnspec","url":"/packer/integrations/mondoohq/cnspec/latest/components/provisioner/cnspec","isCurrentPage":true}]},"__N_SSG":true}