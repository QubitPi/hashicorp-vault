{"pageProps":{"metadata":{"title":"UpCloud | Integrations","description":"A builder plugin for Packer which can be used to generate storage templates on UpCloud."},"product":{"name":"Packer","slug":"packer","algoliaConfig":{"indexName":"product_PACKER","searchOnlyApiKey":"4e1ea7f4bf4335ac43d9f28463e42148"},"analyticsConfig":{"includedDomains":"packer.io www.packer.io","segmentWriteKey":"AjXdfmTTk1I9q9dfyePuDFHBrz1tCO3l"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Packer by HashiCorp","description":"Packer helps you create golden images for multiple platforms from a single source configuration.","image":"https://www.packer.io/packer-public/img/og-image.png","icon":[{"href":"/packer-public/_favicon.ico"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiDays","url":"https://hashicorp.com/conferences/hashidays","text":"One conference. Three cities.","linkText":"Find a city near you","expirationDate":"2024-06-14T00:00:00-08:00"},"version":"1.7.10","basePaths":["docs","guides","intro","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"guide","name":"Guides","path":"guides"}],"integrationsConfig":{"description":"A curated collection of official, partner, and community Packer Integrations."}},"integration":{"id":"43a15779-1257-4553-b2d7-271afac6361a","slug":"upcloud","name":"UpCloud","description":"A builder plugin for Packer which can be used to generate storage templates on UpCloud.","license_type":null,"license_url":null,"external_only":false,"external_url":null,"tier":"partner","repo_url":"https://github.com/UpCloudLtd/packer-plugin-upcloud","subdirectory":"/.web-docs","created_at":"2023-08-14T20:21:38.845Z","updated_at":"2023-12-07T17:23:55.174Z","hide_versions":false,"organization":{"id":"ce9006a0-61e8-490e-9f72-365183a55f4a","slug":"UpCloudLtd","created_at":"2023-08-14T20:21:38.611Z","updated_at":"2023-08-14T20:21:38.611Z"},"product":{"id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","slug":"packer","name":"Packer","created_at":"2022-11-09T22:56:29.896Z","updated_at":"2022-11-09T22:56:29.896Z"},"versions":["1.5.3","1.5.2","0.0.0"],"components":[{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders"},{"id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","slug":"post-processor","name":"Post-Processor","plural_name":"Post-Processors"}],"flags":[],"integration_type":null},"activeRelease":{"id":"906b8792-e8c0-4dbb-a213-e43eda8084ac","integration_id":"43a15779-1257-4553-b2d7-271afac6361a","version":"1.5.3","readme":"This is a plugin for Packer which can be used to generate storage templates on UpCloud. \nIt utilises the [UpCloud Go API](https://github.com/UpCloudLtd/upcloud-go-api) to interface with the UpCloud API.\n\n### Installation\n\nTo install this plugin, copy and paste this code into your Packer configuration, then run [`packer init`](https://www.packer.io/docs/commands/init).\n\n\n```hcl\npacker {\n  required_plugins {\n    upcloud = {\n      version = \">=v1.0.0\"\n      source  = \"github.com/UpCloudLtd/upcloud\"\n    }\n  }\n}\n\n```\n\nAlternatively, you can use `packer plugins install` to manage installation of this plugin.\n\n```sh\n$ packer plugins install github.com/UpCloudLtd/upcloud\n```\n\n\n### Components\n\n#### Builders\n\n\n- [upcloud](/packer/integrations/upcloudltd/upcloud/latest/components/builder/upcloud) - The upcloud builder is used to generate storage templates on UpCloud.\n\n#### Post-processors\n\n- [upcloud-import](/packer/integrations/upcloudltd/upcloud/latest/components/post-processor/import) - The upcloud import post-processors is used to import disk images to UpCloud.\n\n### JSON Templates\nFrom Packer version 1.7.0, template HCL2 becomes officially the preferred way to write Packer configuration. While the `json` format is still supported, but certain new features, such as `packer init` works only in newer HCL2 format.\nIf you are using `json` config templates, please consider upgrading them using the packer built-in command:\n\n```sh\n$ packer hcl2_upgrade example.json\nSuccessfully created example.json.pkr.hcl\n```\n","created_at":"2024-01-02T13:27:38.097Z","updated_at":"2024-01-02T13:27:38.097Z","components":[{"id":"4d3c1c34-6a2e-4324-b311-c366a3873f2c","integration_release_id":"906b8792-e8c0-4dbb-a213-e43eda8084ac","component_id":"36076511-3ced-4faf-addf-101fce0405ff","readme":"\nType: `upcloud`\n\nThe upcloud builder is used to generate storage templates on UpCloud.\n\n<!-- Builder Configuration Fields -->\n\n### Required\n\n<!-- Code generated from the comments of the Config struct in builder/upcloud/config.go; DO NOT EDIT MANUALLY -->\n\n- `username` (string) - The username to use when interfacing with the UpCloud API.\n\n- `password` (string) - The password to use when interfacing with the UpCloud API.\n\n- `zone` (string) - The zone in which the server and template should be created (e.g. nl-ams1).\n\n- `storage_uuid` (string) - The UUID of the storage you want to use as a template when creating the server.\n  \n  Optionally use `storage_name` parameter to find matching storage\n\n<!-- End of code generated from the comments of the Config struct in builder/upcloud/config.go; -->\n\n\n<!--\n  Optional Configuration Fields\n\n  Configuration options that are not required or have reasonable defaults\n  should be listed under the optionals section. Defaults values should be\n  noted in the description of the field\n-->\n\n### Optional\n\n<!-- Code generated from the comments of the Config struct in builder/upcloud/config.go; DO NOT EDIT MANUALLY -->\n\n- `storage_name` (string) - The name of the storage that will be used to find the first matching storage in the list of existing templates.\n  \n  Note that `storage_uuid` parameter has higher priority. You should use either `storage_uuid` or `storage_name` for not strict matching (e.g \"ubuntu server 20.04\").\n\n- `template_prefix` (string) - The prefix to use for the generated template title. Defaults to `custom-image`.\n  You can use this option to easily differentiate between different templates.\n\n- `template_name` (string) - Similarly to `template_prefix`, but this will allow you to set the full template name and not just the prefix.\n  Defaults to an empty string, meaning the name will be the storage title.\n  You can use this option to easily differentiate between different templates.\n  It cannot be used in conjunction with the prefix setting.\n\n- `storage_size` (int) - The storage size in gigabytes. Defaults to `25`.\n  Changing this value is useful if you aim to build a template for larger server configurations where the preconfigured server disk is larger than 25 GB.\n  The operating system disk can also be later extended if needed. Note that Windows templates require large storage size, than default 25 Gb.\n\n- `state_timeout_duration` (duration string | ex: \"1h5m2s\") - The amount of time to wait for resource state changes. Defaults to `5m`.\n\n- `boot_wait` (duration string | ex: \"1h5m2s\") - The amount of time to wait after booting the server. Defaults to '0s'\n\n- `clone_zones` ([]string) - The array of extra zones (locations) where created templates should be cloned.\n  Note that default `state_timeout_duration` is not enough for cloning, better to increase a value depending on storage size.\n\n- `network_interfaces` ([]NetworkInterface) - The array of network interfaces to request during the creation of the server for building the packer image.\n\n- `ssh_private_key_path` (string) - Path to SSH Private Key that will be used for provisioning and stored in the template.\n\n- `ssh_public_key_path` (string) - Path to SSH Public Key that will be used for provisioning.\n\n<!-- End of code generated from the comments of the Config struct in builder/upcloud/config.go; -->\n\n\n#### Network Interfaces object (NetworkInterface)\n\n<!-- Code generated from the comments of the NetworkInterface struct in builder/upcloud/config.go; DO NOT EDIT MANUALLY -->\n\n- `ip_addresses` ([]IPAddress) - List of IP Addresses\n\n- `type` (InterfaceType) - Network type (e.g. public, utility, private)\n\n- `network` (string) - Network UUID when connecting private network\n\n<!-- End of code generated from the comments of the NetworkInterface struct in builder/upcloud/config.go; -->\n\n\n#### IP Address object (IPAddress)\n\n<!-- Code generated from the comments of the IPAddress struct in builder/upcloud/config.go; DO NOT EDIT MANUALLY -->\n\n- `default` (bool) - Default IP address. When set to `true` SSH communicator will connect to this IP after boot.\n\n- `family` (string) - IP address family (IPv4 or IPv6)\n\n- `address` (string) - IP address. Note that at the moment using floating IPs is not supported.\n\n<!-- End of code generated from the comments of the IPAddress struct in builder/upcloud/config.go; -->\n\n\n\n<!--\n  A basic example on the usage of the builder. Multiple examples\n  can be provided to highlight various build configurations.\n\n-->\n### Example Usage\n\nHere is a sample template, which you can also find in the [example](https://github.com/UpCloudLtd/packer-plugin-upcloud/tree/main/example) directory.\nIt reads your UpCloud API credentials from the environment variables, creates an Ubuntu 20.04 LTS server in the `nl-ams1` region and authorizes root user to loggin with your public SSH key.\n\n```hcl\npacker {\n  required_plugins {\n    upcloud = {\n      version = \">=v1.0.0\"\n      source  = \"github.com/UpCloudLtd/upcloud\"\n    }\n  }\n}\n\nvariable \"username\" {\n  type        = string\n  description = \"UpCloud API username\"\n  default     = \"${env(\"UPCLOUD_USERNAME\")}\"\n}\n\nvariable \"password\" {\n  type        = string\n  description = \"UpCloud API password\"\n  default     = \"${env(\"UPCLOUD_PASSWORD\")}\"\n  sensitive   = true\n}\n\nvariable \"ssh_public_key\" {\n  type        = string\n  description = \"Path to your SSH public key file\"\n  default     = \"~/.ssh/id_rsa.pub\"\n}\n\nsource \"upcloud\" \"test\" {\n  username        = \"${var.username}\"\n  password        = \"${var.password}\"\n  zone            = \"nl-ams1\"\n  storage_name    = \"ubuntu server 20.04\"\n  template_prefix = \"ubuntu-server\"\n}\n\nbuild {\n  sources = [\"source.upcloud.test\"]\n\n  provisioner \"shell\" {\n    inline = [\n      \"apt-get update\",\n      \"apt-get upgrade -y\",\n      \"echo '${file(var.ssh_public_key)}' | tee /root/.ssh/authorized_keys\"\n    ]\n  }\n}\n\n```\n\nConfiguration reads your SSH public key from the default location `~/.ssh/id_rsa.pub`. You can overwrite variables using command line argumen `-var`:\n```sh\n$ packer build -var=\"ssh_public_key=/some/other/path/id_rsa.pub\"\n```\n\n#### Network interfaces\nThis template uses `network_interfaces` to define network interfaces to be used during the creation of the server for building the packer image.\n```hcl\npacker {\n  required_plugins {\n    upcloud = {\n      version = \">=v1.0.0\"\n      source  = \"github.com/UpCloudLtd/upcloud\"\n    }\n  }\n}\n\nvariable \"username\" {\n  type        = string\n  description = \"UpCloud API username\"\n  default     = \"${env(\"UPCLOUD_USERNAME\")}\"\n}\n\nvariable \"password\" {\n  type        = string\n  description = \"UpCloud API password\"\n  default     = \"${env(\"UPCLOUD_PASSWORD\")}\"\n  sensitive   = true\n}\n\nvariable \"ssh_public_key\" {\n  type        = string\n  description = \"Path to your SSH public key file\"\n  default     = \"~/.ssh/id_rsa.pub\"\n}\n\nsource \"upcloud\" \"test\" {\n  username        = \"${var.username}\"\n  password        = \"${var.password}\"\n  zone            = \"nl-ams1\"\n  storage_name    = \"ubuntu server 20.04\"\n  template_prefix = \"ubuntu-server\"\n\n  network_interfaces {\n    ip_addresses {\n      family = \"IPv4\"\n    }\n    type = \"public\"\n  }\n\n  network_interfaces {\n    ip_addresses {\n      family = \"IPv4\"\n    }\n    type = \"utility\"\n  }\n}\n\nbuild {\n  sources = [\"source.upcloud.test\"]\n\n  provisioner \"shell\" {\n    inline = [\n      \"apt-get update\",\n      \"apt-get upgrade -y\",\n      \"echo '${file(var.ssh_public_key)}' | tee /root/.ssh/authorized_keys\"\n    ]\n  }\n}\n\n```\n\n#### IPv6 network interfaces\n```hcl\npacker {\n  required_plugins {\n    upcloud = {\n      version = \">=v1.0.0\"\n      source  = \"github.com/UpCloudLtd/upcloud\"\n    }\n  }\n}\n\nvariable \"username\" {\n  type        = string\n  description = \"UpCloud API username\"\n  default     = \"${env(\"UPCLOUD_USERNAME\")}\"\n}\n\nvariable \"password\" {\n  type        = string\n  description = \"UpCloud API password\"\n  default     = \"${env(\"UPCLOUD_PASSWORD\")}\"\n  sensitive   = true\n}\n\nvariable \"ssh_public_key\" {\n  type        = string\n  description = \"Path to your SSH public key file\"\n  default     = \"~/.ssh/id_rsa.pub\"\n}\n\nsource \"upcloud\" \"test\" {\n  username        = \"${var.username}\"\n  password        = \"${var.password}\"\n  zone            = \"fi-hel1\"\n  storage_name    = \"Debian GNU/Linux 11 (Bullseye)\"\n  template_prefix = \"debian11\"\n  network_interfaces {\n    ip_addresses {\n      family = \"IPv6\"\n    }\n    type = \"public\"\n  }\n  communicator = \"ssh\"\n\n  # Use bastion host if no IPv6 connection is available\n  # ssh_bastion_username         = \"<bastion_username>\"\n  # ssh_bastion_host             = \"<bastion_host>\"\n  # ssh_bastion_private_key_file = \"<bastion_private_key_file>\"\n}\n\nbuild {\n  sources = [\"source.upcloud.test\"]\n\n  provisioner \"shell\" {\n    environment_vars = [\n      \"DEBIAN_FRONTEND=noninteractive\",\n      \"APT_LISTCHANGES_FRONTEND=none\",\n    ]\n\n    inline = [\n      \"apt-get update\",\n      \"apt-get upgrade -y\",\n      \"echo '${file(var.ssh_public_key)}' | tee /root/.ssh/authorized_keys\",\n    ]\n  }\n}\n\n```\n\n#### Private network interfaces\n```hcl\npacker {\n  required_plugins {\n    upcloud = {\n      version = \">=v1.0.0\"\n      source  = \"github.com/UpCloudLtd/upcloud\"\n    }\n  }\n}\n\nvariable \"username\" {\n  type        = string\n  description = \"UpCloud API username\"\n  default     = \"${env(\"UPCLOUD_USERNAME\")}\"\n}\n\nvariable \"password\" {\n  type        = string\n  description = \"UpCloud API password\"\n  default     = \"${env(\"UPCLOUD_PASSWORD\")}\"\n  sensitive   = true\n}\n\nvariable \"ssh_public_key\" {\n  type        = string\n  description = \"Path to your SSH public key file\"\n  default     = \"~/.ssh/id_rsa.pub\"\n}\n\nsource \"upcloud\" \"test\" {\n  username        = \"${var.username}\"\n  password        = \"${var.password}\"\n  zone            = \"fi-hel1\"\n  storage_name    = \"Debian GNU/Linux 11 (Bullseye)\"\n  template_prefix = \"debian11\"\n\n  network_interfaces {\n    ip_addresses {\n      default = true\n      address = \"10.0.0.20\"\n      family  = \"IPv4\"\n    }\n    network = \"<network_uuid>\"\n    type    = \"private\"\n  }\n  communicator = \"ssh\"\n\n  # Use bastion host to get access to private network\n  # ssh_bastion_username         = \"<bastion_username>\"\n  # ssh_bastion_host             = \"<bastion_host>\"\n  # ssh_bastion_private_key_file = \"<bastion_private_key_file>\"\n}\n\nbuild {\n  sources = [\"source.upcloud.test\"]\n\n  provisioner \"shell\" {\n    environment_vars = [\n      \"DEBIAN_FRONTEND=noninteractive\",\n      \"APT_LISTCHANGES_FRONTEND=none\",\n    ]\n\n    inline = [\n      \"apt-get update\",\n      \"apt-get upgrade -y\",\n      \"echo '${file(var.ssh_public_key)}' | tee /root/.ssh/authorized_keys\",\n    ]\n  }\n}\n\n```\n","created_at":"2024-01-02T13:27:39.484Z","updated_at":"2024-01-02T13:27:39.484Z","name":"UpCloud","slug":"upcloud","component":{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:30.937Z","updated_at":"2022-11-09T22:56:30.937Z"},"variable_groups":[]},{"id":"bc9c7367-abf0-4f57-a67f-062d4de8736c","integration_release_id":"906b8792-e8c0-4dbb-a213-e43eda8084ac","component_id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","readme":null,"created_at":"2024-01-02T13:27:39.825Z","updated_at":"2024-01-02T13:27:39.825Z","name":"UpCloud Import","slug":"import","component":{"id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","slug":"post-processor","name":"Post-Processor","plural_name":"Post-Processors","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.157Z","updated_at":"2023-07-26T17:26:54.831Z"},"variable_groups":[]}]},"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Packer","url":"/packer"},{"title":"Integrations","url":"/packer/integrations"},{"title":"UpCloud","url":"/packer/integrations/UpCloudLtd/upcloud","isCurrentPage":true}],"anchorLinks":[{"id":"installation","level":3,"title":"Installation"},{"id":"components","level":3,"title":"Components"},{"id":"builders","level":4,"title":"Builders"},{"id":"post-processors","level":4,"title":"Post-processors"},{"id":"json-templates","level":3,"title":"JSON Templates"}],"serializedREADME":{"compiledSource":"const layoutProps={};const MDXLayout=\"wrapper\";function MDXContent({components,...props}){return mdx(MDXLayout,{...layoutProps,...props,components:components,mdxType:\"MDXLayout\"},mdx(\"p\",{\"className\":\"g-type-long-body\"},`This is a plugin for Packer which can be used to generate storage templates on UpCloud.\nIt utilises the `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/UpCloudLtd/upcloud-go-api\"},`UpCloud Go API`),` to interface with the UpCloud API.`),mdx(\"h3\",{\"id\":\"user-content-installation\",\"data-text-content\":\"Installation\",\"className\":\"g-type-display-4\"},`Installation`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`To install this plugin, copy and paste this code into your Packer configuration, then run `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.packer.io/docs/commands/init\"},mdx(\"inlineCode\",{parentName:\"a\"},`packer init`)),`.`),mdx(\"pre\",{\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},`packer`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},`required_plugins`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`upcloud`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`version`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\">=v1.0.0\"`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`source`),`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"github.com/UpCloudLtd/upcloud\"`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Alternatively, you can use `,mdx(\"inlineCode\",{parentName:\"p\"},`packer plugins install`),` to manage installation of this plugin.`),mdx(\"pre\",{\"className\":\"language-sh\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-sh\"},`$ packer plugins install github.com/UpCloudLtd/upcloud`,`\n`)),mdx(\"h3\",{\"id\":\"user-content-components\",\"data-text-content\":\"Components\",\"className\":\"g-type-display-4\"},`Components`),mdx(\"h4\",{\"id\":\"user-content-builders\",\"data-text-content\":\"Builders\",\"className\":\"g-type-display-5\"},`Builders`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"href\":\"/packer/integrations/upcloudltd/upcloud/latest/components/builder/upcloud\"},`upcloud`),` - The upcloud builder is used to generate storage templates on UpCloud.`)),mdx(\"h4\",{\"id\":\"user-content-post-processors\",\"data-text-content\":\"Post-processors\",\"className\":\"g-type-display-5\"},`Post-processors`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"href\":\"/packer/integrations/upcloudltd/upcloud/latest/components/post-processor/import\"},`upcloud-import`),` - The upcloud import post-processors is used to import disk images to UpCloud.`)),mdx(\"h3\",{\"id\":\"user-content-json-templates\",\"data-text-content\":\"JSON Templates\",\"className\":\"g-type-display-4\"},`JSON Templates`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`From Packer version 1.7.0, template HCL2 becomes officially the preferred way to write Packer configuration. While the `,mdx(\"inlineCode\",{parentName:\"p\"},`json`),` format is still supported, but certain new features, such as `,mdx(\"inlineCode\",{parentName:\"p\"},`packer init`),` works only in newer HCL2 format.\nIf you are using `,mdx(\"inlineCode\",{parentName:\"p\"},`json`),` config templates, please consider upgrading them using the packer built-in command:`),mdx(\"pre\",{\"className\":\"language-sh\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-sh\"},`$ packer hcl2_upgrade example.json`,`\n`,`Successfully created example.json.pkr.hcl`,`\n`)))};MDXContent.isMDXComponent=true;","scope":{}}},"__N_SSG":true}