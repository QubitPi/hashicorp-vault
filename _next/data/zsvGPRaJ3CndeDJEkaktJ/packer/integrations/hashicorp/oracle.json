{"pageProps":{"metadata":{"title":"Oracle | Integrations","description":"The Oracle multi-component plugin can be used with HashiCorp Packer to create custom images."},"product":{"name":"Packer","slug":"packer","algoliaConfig":{"indexName":"product_PACKER","searchOnlyApiKey":"4e1ea7f4bf4335ac43d9f28463e42148"},"analyticsConfig":{"includedDomains":"packer.io www.packer.io","segmentWriteKey":"AjXdfmTTk1I9q9dfyePuDFHBrz1tCO3l"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Packer by HashiCorp","description":"Packer helps you create golden images for multiple platforms from a single source configuration.","image":"https://www.packer.io/packer-public/img/og-image.png","icon":[{"href":"/packer-public/_favicon.ico"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiDays","url":"https://hashicorp.com/conferences/hashidays","text":"One conference. Three cities.","linkText":"Find a city near you","expirationDate":"2024-06-14T00:00:00-08:00"},"version":"1.7.10","basePaths":["docs","guides","intro","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"guide","name":"Guides","path":"guides"}],"integrationsConfig":{"description":"A curated collection of official, partner, and community Packer Integrations."}},"integration":{"id":"f451b9c9-3739-4a64-9077-57251c41ddf4","slug":"oracle","name":"Oracle","description":"The Oracle multi-component plugin can be used with HashiCorp Packer to create custom images.","license_type":null,"license_url":null,"external_only":false,"external_url":null,"tier":"community","repo_url":"https://github.com/hashicorp/packer-plugin-oracle","subdirectory":"/.web-docs","created_at":"2023-04-25T20:05:46.779Z","updated_at":"2023-08-08T17:01:14.628Z","hide_versions":false,"organization":{"id":"a4a0551a-1451-4d89-9f56-8031c8350c77","slug":"hashicorp","created_at":"2022-11-09T22:56:32.391Z","updated_at":"2022-11-09T22:56:32.391Z"},"product":{"id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","slug":"packer","name":"Packer","created_at":"2022-11-09T22:56:29.896Z","updated_at":"2022-11-09T22:56:29.896Z"},"versions":["1.1.0","1.0.5","1.0.4","1.0.2","1.0.1","1.0.0"],"components":[{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders"},{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders"}],"flags":[{"id":"3709e036-b45f-4be8-9043-f7c8cc2af00f","slug":"hcp-ready","name":"HCP Ready","description":"This integration has been tested to work with HashiCorp Cloud Platform (HCP)","created_at":"2022-11-09T22:56:30.673Z","updated_at":"2022-11-09T22:56:30.673Z"}],"integration_type":null},"activeRelease":{"id":"84bab319-33fd-40e6-ae3d-6d43ad66e5bb","integration_id":"f451b9c9-3739-4a64-9077-57251c41ddf4","version":"1.1.0","readme":"This plugin allows Packer to communicate with the Oracle cloud platform.\nIt is able to create custom images on both Oracle Cloud Infrastructure and\nOracle Cloud Infrastructure Classic Compute. This plugin comes with builders\ndesigned to support both platforms.\n\n## Installation\n\nTo install this plugin, copy and paste this code into your Packer configuration, then run [`packer init`](https://www.packer.io/docs/commands/init).\n\n```hcl\npacker {\n  required_plugins {\n    oracle = {\n      source  = \"github.com/hashicorp/oracle\"\n      version = \"~> 1\"\n    }\n  }\n}\n```\n\nAlternatively, you can use `packer plugins install` to manage installation of this plugin.\n\n```sh\n$ packer plugins install github.com/hashicorp/oracle\n```\n\n## Components\n\n### Builders\n\n- [oracle-classic](/packer/integrations/hashicorp/oracle/latest/components/builder/oci) - Create custom images in Oracle Cloud Infrastructure\n    Classic Compute by launching a source instance and creating an image list from a snapshot of it after provisioning.\n\n- [oracle-oci](/packer/integrations/hashicorp/oracle/latest/components/builder/classic) - Create custom images in Oracle Cloud Infrastructure (OCI) by\n    launching a base instance and creating an image from it after provisioning.\n\n## Oracle Classic Authentication\n\nThis builder authenticates API calls to Oracle Cloud Infrastructure Classic\nCompute using basic authentication (user name and password). To read more, see\nthe [authentication\ndocumentation](https://docs.oracle.com/en/cloud/iaas/compute-iaas-cloud/stcsa/Authentication.html)\n\n\n\n## Oracle OCI Authentication\n\nThere are three authentication methods available for the OCI builder. The API\nSigning Key of the `DEFAULT` profile in the OCI\n [SDK and CLI Configuration File](https://docs.oracle.com/en-us/iaas/Content/API/Concepts/sdkconfig.htm#SDK_and_CLI_Configuration_File)\n will be used by default.\n\n### Policy Reference\n\nWhen running the `oracle-oci` builder as a non-administrative user, you will need to have OCI policies defined which will enable Packer to do its job.  \n\nThe following represent minimal required policies for the plugin to operate:\n\n```\nAllow group PackerGroup to manage instance-family in compartment ${COMPARTMENT_NAME}\nAllow group PackerGroup to manage instance-images in compartment ${COMPARTMENT_NAME}\nAllow group PackerGroup to use virtual-network-family in compartment ${COMPARTMENT_NAME}\nAllow group PackerGroup to manage compute-image-capability-schema in tenancy\n```\n\nThis example assumes the user running Packer is in a group named 'PackerGroup'.  You will need to update ${COMPARTMENT_NAME} to the name of the\ncompartment in which the plugin is managing resources.\n\nFor more details on working with OCI Policies, please refer to the [OCI Policy Documentation](https://docs.oracle.com/en-us/iaas/Content/Identity/policiesgs/get-started-with-policies.htm)\n\n### API Signing Key\n\nThe OCI REST API requires that requests be signed with the RSA public key\nassociated with your\n[IAM](https://docs.us-phoenix-1.oraclecloud.com/Content/Identity/Concepts/overview.htm)\nuser account. For a comprehensive example of how to configure the required\nauthentication see the documentation on [Required Keys and\nOCIDs](https://docs.us-phoenix-1.oraclecloud.com/Content/API/Concepts/apisigningkey.htm)\n([Oracle Cloud\nIDs](https://docs.us-phoenix-1.oraclecloud.com/Content/General/Concepts/identifiers.htm)).\n\n### Instance Principal\n\nIf you run Packer on an OCI compute instance, you can configure Packer to use the\n[Instance Principal](https://docs.cloud.oracle.com/en-us/iaas/Content/Identity/Tasks/callingservicesfrominstances.htm)\nassociated with that instance to authenticate instead of an API Signing Key that\nis associated with a specific user. This method requires the creation of appropriately configured\n[Dynamic Groups](https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingdynamicgroups.htm)\nand [Policies](https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm).\n\nThe [`use_instance_principals`](https://www.packer.io/docs/builders/oracle/oci#use_instance_principals)\nparameter is used to enable this method.\n\nThe [`oci_instance_principals.pkr.hcl`](/example/oci_instance_principals.pkr.hcl)\nand [`oci_instance_principals.json`](/example/oci_instance_principals.json) examples can be used as a reference for\nconfiguring this authentication method.\n\n### Security Token\n\n[Token-based authentication](https://docs.oracle.com/en-us/iaas/Content/API/SDKDocs/clitoken.htm)\nrequires you to interactively authenticate a session using the OCI CLI and a web\nbrowser. The token that is created has an extremely limited TTL and must be\nrefreshed every hour for up to 24 hours. However, this method allows for\nauthentication using non-SCIM supported federated identity providers.\n\nTo use token-based authentication, start a new session using the CLI's\n[`oci session authenticate`](https://docs.oracle.com/en-us/iaas/Content/API/SDKDocs/clitoken.htm#Starting)\ncommand and provide the path to the configuration file as the `access_cfg_file`\nconfiguration parameter and the name of the profile as the `access_cfg_file_account`\nconfiguration parameter.\n\nThe [`oci_security_token.pkr.hcl`](/example/oci_security_token.pkr.hcl) and\n[`oci_security_token.json`](/example/oci_security_token.json) examples can be\nused as a reference for this method.\n","created_at":"2024-03-06T21:44:30.808Z","updated_at":"2024-03-06T21:44:30.808Z","components":[{"id":"d96b023c-c7d4-4cf0-812f-14b7931e136c","integration_release_id":"84bab319-33fd-40e6-ae3d-6d43ad66e5bb","component_id":"36076511-3ced-4faf-addf-101fce0405ff","readme":"Type: `oracle-oci`\nArtifact BuilderId: `packer.oracle.oci`\n\nThe `oracle-oci` Packer builder is able to create new custom images for use\nwith [Oracle Cloud Infrastructure](https://cloud.oracle.com) (OCI). The builder\ntakes a base image, runs any provisioning necessary on the base image after\nlaunching it, and finally snapshots it creating a reusable custom image.\n\nIt is recommended that you familiarise yourself with the [Key Concepts and\nTerminology](https://docs.us-phoenix-1.oraclecloud.com/Content/GSG/Concepts/concepts.htm)\nprior to using this builder if you have not done so already.\n\nThe builder _does not_ manage images. Once it creates an image, it is up to you\nto use it or delete it.\n\n## Configuration Reference\n\nThere are many configuration options available for the `oracle-oci` builder. In\naddition to the options listed here, a\n[communicator](/packer/docs/templates/legacy_json_templates/communicator) can be configured for this\nbuilder.\n\nIn addition to the options defined there, a private key file\ncan also be supplied to override the typical auto-generated key:\n\n- `ssh_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the home directory\n  of current user.\n\n\n### Required configuration parameters\n\n- `availability_domain` (string) - The name of the [Availability\n  Domain](https://docs.us-phoenix-1.oraclecloud.com/Content/General/Concepts/regions.htm)\n  within which a new instance is launched and provisioned. The names of the\n  Availability Domains have a prefix that is specific to your\n  [tenancy](https://docs.us-phoenix-1.oraclecloud.com/Content/GSG/Concepts/concepts.htm#two).\n\n  To get a list of the Availability Domains, use the\n  [ListAvailabilityDomains](https://docs.us-phoenix-1.oraclecloud.com/api/#/en/identity/latest/AvailabilityDomain/ListAvailabilityDomains)\n  operation, which is available in the IAM Service API.\n\n- `base_image_ocid` (string) - The OCID of the [base\n  image](https://docs.us-phoenix-1.oraclecloud.com/Content/Compute/References/images.htm)\n  to use. This is the unique identifier of the image that will be used to\n  launch a new instance and provision it.\n\n  To get a list of the accepted image OCIDs, use the\n  [ListImages](https://docs.us-phoenix-1.oraclecloud.com/api/#/en/iaas/latest/Image/ListImages)\n  operation available in the Core Services API.\n\n- `base_image_filter` (map of strings) - As an alternative to providing `base_image_ocid`,\n  the user can supply search criteria, and Packer will use the the most recent image that meets\n  all search criteria. If no image meets all search criteria, Packer returns an error. The\n  following fields, if specified, must match exactly:\n\n  - `compartment_id` - The OCID of the compartment to find the image. If not specified, will use `compartment_ocid`\n    used for the instance.\n  - `display_name` - The full name of the image, e.g., `Oracle-Linux-7.8-2020.05.26-0`\n  - `operating_system` - The operating system used on the image, e.g., `Oracle Linux`\n  - `operating_system_version` - The version of the operating system on the image, e.g., `7.8`\n  - `shape` - A shape that the image supports. If not specified, will use `shape` used for the instance\n\n  Additionally, the following field takes a regular expression:\n\n  - `display_name_search` - a regular expression for the display name, e.g., `^Oracle-Linux`. This\n    is ignored if `display_name` is also specified under `base_image_filter`. If no images match\n    the expression, Packer returns an error. If multiple images match, the most recent is used.\n\n  `base_image_filter` is ignored if `base_image_ocid` is also specified.\n\n- `compartment_ocid` (string) - The OCID of the\n  [compartment](https://docs.us-phoenix-1.oraclecloud.com/Content/GSG/Tasks/choosingcompartments.htm) that the instance will run in.\n\n- `shape` (string) - The template that determines the number of CPUs, amount\n  of memory, and other resources allocated to a newly created instance.\n\n  To get a list of the available shapes, use the\n  [ListShapes](https://docs.us-phoenix-1.oraclecloud.com/api/#/en/iaas/20160918/Shape/ListShapes)\n  operation available in the Core Services API.\n\n  When using flexible shapes, `ocpus` must be set.\n\n- `subnet_ocid` (string) - The name of the subnet within which a new instance\n  is launched and provisioned.\n\n  To get a list of your subnets, use the\n  [ListSubnets](https://docs.us-phoenix-1.oraclecloud.com/api/#/en/iaas/latest/Subnet/ListSubnets)\n  operation available in the Core Services API.\n\n  Note: the subnet must be configured to allow access via your chosen\n  [communicator](/packer/docs/communicators) (communicator defaults to\n  [SSH tcp/22](/packer/docs/communicators/ssh#ssh_port)).\n\n\n### Authentication parameters\n\nEach of the following configuration parameters is either **mandatory** or **unacceptable**\nbased on which authentication method is used.\n\n- `use_instance_principals` (boolean) - Whether to use [Instance\n  Principals](https://docs.cloud.oracle.com/en-us/iaas/Content/Identity/Tasks/callingservicesfrominstances.htm)\n  instead of User Principals. If this key is set to true, setting any one of the `access_cfg_file`,\n  `access_cfg_file_account`, `region`, `tenancy_ocid`, `user_ocid`, `key_file`, `fingerprint`,\n  `pass_phrase` parameters will cause an invalid configuration error.\n  Defaults to `false`.\n\n- `access_cfg_file` (string) - The path to the [OCI config\n  file](https://docs.us-phoenix-1.oraclecloud.com/Content/API/Concepts/sdkconfig.htm).\n  This parameter is _optional_ when using token-based authentication.\n  This parameter _cannot_ be used along with the `use_instance_principals` key.\n  Defaults to `$HOME/.oci/config`.\n\n- `access_cfg_file_account` (string) - The specific account in the [OCI config\n  file](https://docs.us-phoenix-1.oraclecloud.com/Content/API/Concepts/sdkconfig.htm) to use.\n  This parameter is _mandatory_ when using token-based authentication.\n  This parameter _cannot_ be used along with the `use_instance_principals` key.\n  Defaults to `DEFAULT`.\n\n\n### Overriding authentication defaults\n\nThe following parameters can be used to override the default value provided by\nor configured for the default OCI CLI authenticaton profile.\n\n- `region` (string) - An Oracle Cloud Infrastructure region. Overrides value provided by the\n  [OCI config file](https://docs.us-phoenix-1.oraclecloud.com/Content/API/Concepts/sdkconfig.htm)\n  if present. This cannot be used along with the `use_instance_principals` key.\n\n- `tenancy_ocid` (string) - The OCID of your tenancy. Overrides value provided by the [OCI config\n  file](https://docs.us-phoenix-1.oraclecloud.com/Content/API/Concepts/sdkconfig.htm) if present.\n  This cannot be used along with the `use_instance_principals` key.\n\n- `user_ocid` (string) - The OCID of the user calling the OCI API. Overrides value provided by the\n  [OCI config file](https://docs.us-phoenix-1.oraclecloud.com/Content/API/Concepts/sdkconfig.htm)\n  if present. This cannot be used along with the `use_instance_principals` key.\n\n- `key_file` (string) - Full path and filename of the OCI API signing key. Overrides value provided\n  by the [OCI config file](https://docs.us-phoenix-1.oraclecloud.com/Content/API/Concepts/sdkconfig.htm)\n  if present. This cannot be used along with the `use_instance_principals` key.\n\n- `fingerprint` (string) - Fingerprint for the OCI API signing key. Overrides value provided by the\n  [OCI config file](https://docs.us-phoenix-1.oraclecloud.com/Content/API/Concepts/sdkconfig.htm) if\n  present. This cannot be used along with the `use_instance_principals` key.\n\n- `pass_phrase` (string) - Pass phrase used to decrypt the OCI API signing key. Overrides value provided\n  by the [OCI config file](https://docs.us-phoenix-1.oraclecloud.com/Content/API/Concepts/sdkconfig.htm)\n  if present. This cannot be used along with the `use_instance_principals` key.\n\n  ### Additional configuration parameters\n\n- `skip_create_image` (bool) - Skip creating the image. Useful for setting to `true` during a build test stage. Defaults to `false`.\n\n- `image_name` (string) - The name to assign to the resulting custom image.\n\n- `image_compartment_ocid` (string) - The OCID of the target compartment for the resulting image. Defaults to `compartment_ocid`.\n\n- `instance_name` (string) - The name to assign to the instance used for the image creation process.\n  If not set a name of the form `instanceYYYYMMDDhhmmss` will be used.\n\n- `instance_tags` (map of strings) - Add one or more freeform tags to the instance used for the\n  image creation process.\n\n- `instance_defined_tags_json` (string) - Json string to add one or more defined tags for a given namespace\n   to the instance used for the image creation process. Only works on HCL2 templates. For old-style JSON templates,\n   use [instance_defined_tags](#instance_defined_tags) instead.\n\n  ```hcl\n  instance_defined_tags_json = jsonencode({\n    \"Operations\" = {\n      \"Environment\" = \"prod\"\n      \"Team\"        = \"CostCenter\"\n    }\n  })\n  ```\n\n- `instance_defined_tags` (map of maps of strings) - Add one or more defined tags for a given namespace\n  to the instance used for the image creation process. Only works on old-style JSON templates. For HCL2 templates,\n  use [instance_defined_tags_json](#instance_defined_tags_json) instead.\n\n- `create_vnic_details` (map of strings) - Specify details for the virtual network interface card (VNIC)\n  that is attached to the instance. Possible keys (all optional) are: `assign_public_ip` (bool),\n  `display_name` (string), `hostname_lable` (string), `nsg_ids` (list), `private_ip` (string),\n  `skip_source_dest_check` (bool), `subnet_id` (string), `tags` (map of string). Besides the previous keys, the `defined_tags`\n  (map of maps of strings) is also available on old-style JSON templates, while `defined_tags_json` (string) is the json\n  string equivalent variant for HCL2 templates. See\n  [the Oracle docs](https://docs.cloud.oracle.com/en-us/iaas/Content/Network/Tasks/managingVNICs.htm)\n  for more information about VNICs.\n\n- `disk_size` (int64) - The size of the boot volume in GBs. Minimum value is 50 and maximum value is 16384 (16TB).\n  Sets the [BootVolumeSizeInGBs](https://godoc.org/github.com/oracle/oci-go-sdk/core#InstanceConfigurationInstanceSourceViaImageDetails)\n  when launching the instance. Defaults to `50`.\n\n- `image_launch_mode` (string) - Specifies the configuration mode for launching instances.\n  Valid values are `\"NATIVE\"`, `\"EMULATED\"`, `\"PARAVIRTUALIZED\"`, and `\"CUSTOM\"`. See the\n  [Oracle CLI docs](https://docs.cloud.oracle.com/en-us/iaas/tools/oci-cli/2.12.5/oci_cli_docs/cmdref/compute/image/create.html#cmdoption-launch-mode)\n  for more information about these modes.\n\n- `nic_attachment_type` (string) - Emulation type for the NIC card of the image.\n  Valid values are `\"E1000\"`, `\"VFIO\"`, and `\"PARAVIRTUALIZED\"`. For applications that require VFIO networking for performance reasons this setting allows for the image to default to this network type. \n\n- `use_private_ip` (boolean) - Use private ip addresses to connect to the\n  instance via ssh.\n\n- `shape_config` (object) - The shape configuration for an instance. The shape configuration determines the resources\n  allocated to an instance. Options:\n  - `ocpus` (required when using flexible shapes or memory_in_gbs is set) (float32) - The total number of OCPUs available to the instance.\n  - `memory_in_gbs` (optional) (float32) - The total amount of memory, in gigabytes, available to the instance.\n  - `baseline_ocpu_utilization` (optional) (string) - The baseline OCPU utilization for a burstable instance.\n    Valid values are `\"BASELINE_1_8\"`, `\"BASELINE_1_2\"`and `\"BASELINE_1_1\"`.\n\n<!-- markdown-link-check-disable -->\n\n- `metadata` (map of strings) - Metadata optionally contains custom metadata\nkey/value pairs provided in the configuration. While this can be used to\nset metadata\\[\"user_data\"\\] the explicit \"user_data\" and\n\"user_data_file\" values will have precedence. An instance's metadata can\nbe obtained from at [http://169.254.169.254](http://169.254.169.254) on\nthe launched instance.\n<!-- markdown-link-check-enable -->\n\n- `user_data` (string) - User data to be used by cloud-init. See [the Oracle\n  docs](https://docs.us-phoenix-1.oraclecloud.com/api/#/en/iaas/20160918/LaunchInstanceDetails)\n  for more details. Generally speaking, it is easier to use the\n  `user_data_file`, but you can use this option to put either the plaintext\n  data or the base64 encoded data directly into your Packer config. Packer\n  will not automatically wait for a user script to finish before shutting\n  down the instance this must be handled in a provisioner.\n\n- `user_data_file` (string) - Path to a file to be used as user data by\n  cloud-init. See [the Oracle\n  docs](https://docs.us-phoenix-1.oraclecloud.com/api/#/en/iaas/20160918/LaunchInstanceDetails)\n  for more details. Example: `\"user_data_file\": \"./boot_config/myscript.sh\"`\n\n- `tags` (map of strings) - Add one or more freeform tags to the resulting\n  custom image. See [the Oracle\n  docs](https://docs.cloud.oracle.com/iaas/Content/Identity/Concepts/taggingoverview.htm)\n  for more details. Example:\n\n```yaml\n'tags':\n  'tag1': 'value1'\n  'tag2': 'value2'\n```\n\n- `defined_tags_json` (string) - JSON string to add one or more defined tags for a given namespace to the resulting\n  custom image. Only works on HCL2 templates. For old-style JSON templates, use [defined_tags](#defined_tags) instead.\n\n  ```hcl\n  defined_tags_json = jsonencode({\n    \"tag1\" = {\n      \"tag1.2\" = \"value1\"\n    }\n    \"tag2\" = \"value2\"\n  })\n  ```\n\n  See [the Oracle docs](https://docs.cloud.oracle.com/iaas/Content/Identity/Concepts/taggingoverview.htm) for more details.\n\n- `defined_tags` (map of map of strings) - Add one or more defined tags for a given namespace to the resulting\n  custom image. Only works on old-style JSON templates. For HCL2 templates,\nuse [defined_tags_json](#defined_tags_json) instead. See [the Oracle\n  docs](https://docs.cloud.oracle.com/iaas/Content/Identity/Concepts/taggingoverview.htm)\n  for more details. Example:\n\n```yaml\n'tags':\n  'namespace': { 'tag1': 'value1', 'tag2': 'value2' }\n```\n\n## Basic Example\n\nHere is a basic example. Note that account specific configuration has been\nsubstituted with the letter `a` and OCIDS have been shortened for brevity.\n\n\n**HCL2**\n\n```hcl\nsource \"oracle-oci\" \"example\" {\n  availability_domain = \"aaaa:PHX-AD-1\"\n  base_image_ocid     = \"ocid1.image.oc1.phx.aaaaaaaa5yu6pw3riqtuhxzov7fdngi4tsteganmao54nq3pyxu3hxcuzmoa\"\n  compartment_ocid    = \"ocid1.compartment.oc1..aaa\"\n  image_name          = \"ExampleImage\"\n  shape               = \"VM.Standard1.1\"\n  ssh_username        = \"opc\"\n  subnet_ocid         = \"ocid1.subnet.oc1..aaa\"\n}\n\nbuild {\n  sources = [\"source.oracle-oci.example\"]\n}\n\n```\n\n**JSON**\n\n```json\n{\n  \"availability_domain\": \"aaaa:PHX-AD-1\",\n  \"base_image_ocid\": \"ocid1.image.oc1.phx.aaaaaaaa5yu6pw3riqtuhxzov7fdngi4tsteganmao54nq3pyxu3hxcuzmoa\",\n  \"compartment_ocid\": \"ocid1.compartment.oc1..aaa\",\n  \"image_name\": \"ExampleImage\",\n  \"shape\": \"VM.Standard1.1\",\n  \"ssh_username\": \"opc\",\n  \"subnet_ocid\": \"ocid1.subnet.oc1..aaa\",\n  \"type\": \"oracle-oci\"\n}\n```\n\n\n\n## Using Instance Principals\n\nHere is a basic example. Note that account specific configuration has been\nsubstituted with the letter `a` and OCIDS have been shortened for brevity.\n\n**HCL2**\n\n```hcl\nsource \"oracle-oci\" \"example\" {\n  availability_domain     = \"aaaa:PHX-AD-1\"\n  base_image_ocid         = \"ocid1.image.oc1.phx.aaaaaaaa5yu6pw3riqtuhxzov7fdngi4tsteganmao54nq3pyxu3hxcuzmoa\"\n  compartment_ocid        = \"ocid1.compartment.oc1..aaa\"\n  image_name              = \"ExampleImage\"\n  shape                   = \"VM.Standard2.1\"\n  ssh_username            = \"opc\"\n  subnet_ocid             = \"ocid1.subnet.oc1..aaa\"\n  use_instance_principals = \"true\"\n}\n\nbuild {\n  sources = [\"source.oracle-oci.example\"]\n}\n\n```\n\n**JSON**\n\n```json\n{\n  \"use_instance_principals\": \"true\",\n  \"availability_domain\": \"aaaa:PHX-AD-1\",\n  \"base_image_ocid\": \"ocid1.image.oc1.phx.aaaaaaaa5yu6pw3riqtuhxzov7fdngi4tsteganmao54nq3pyxu3hxcuzmoa\",\n  \"compartment_ocid\": \"ocid1.compartment.oc1..aaa\",\n  \"image_name\": \"ExampleImage\",\n  \"shape\": \"VM.Standard2.1\",\n  \"ssh_username\": \"opc\",\n  \"subnet_ocid\": \"ocid1.subnet.oc1..aaa\",\n  \"type\": \"oracle-oci\"\n}\n```\n\n\n\n```shell-session\n[opc@packerhost ~]$ packer build packer.json\noracle-oci: output will be in this color.\n\n==> oracle-oci: Creating temporary ssh key for instance...\n==> oracle-oci: Creating instance...\n==> oracle-oci: Created instance (ocid1.instance.oc1.phx.aaa).\n==> oracle-oci: Waiting for instance to enter 'RUNNING' state...\n==> oracle-oci: Instance 'RUNNING'.\n==> oracle-oci: Instance has IP: 10.10.10.10.\n==> oracle-oci: Using ssh communicator to connect: 10.10.10.10\n==> oracle-oci: Waiting for SSH to become available...\n==> oracle-oci: Connected to SSH!\n==> oracle-oci: Creating image from instance...\n==> oracle-oci: Image created.\n==> oracle-oci: Terminating instance (ocid1.instance.oc1.phx.aaa)...\n==> oracle-oci: Terminated instance.\nBuild 'oracle-oci' finished.\n\n==> Builds finished. The artifacts of successful builds are:\n--> oracle-oci: An image was created: 'ExampleImage' (OCID: ocid1.image.oc1.phx.aaa) in region 'us-phoenix-1'\n[opc@packerhost ~]$\n```\n\n## Assigning Tags and Network Security Groups to the Instance\n\nTags are useful for breaking down costs and usage. The keys `instance_tags`\nand `instance_defined_tags` are assigned to the temporary instance,\nwhereas `tags` and `defined_tags` are assigned to the resulting image.\n\nNetwork Security Groups (NSGs) are used for granting networking permissions\nto the instance. Depending on network (VCN and subnet) setup, this may be\nrequired for Packer to successfully SSH into the instance. NSGs are a property\nof the virtual network interface card (VNIC) attached to the instance, and\nare listed in `nsg_ids` under `create_vnic_details`.\n\n**HCL2**\n\n```hcl\nlocals {\n  timestamp = \"${formatdate(\"YYYYMMDDhhmmss\", timestamp())}\"\n}\n\nsource \"oracle-oci\" \"base-image-example\" {\n  availability_domain = \"aaaa:PHX-AD-1\"\n  base_image_ocid     = \"ocid1.image.oc1.iad.aaa\"\n  compartment_ocid    = \"ocid1.compartment.oc1..aaa\"\n  create_vnic_details {\n    assign_public_ip = \"false\"\n    display_name     = \"testing-123\"\n    nsg_ids          = [\"ocid1.networksecuritygroup.oc1.iad.aaa\"]\n  }\n  image_name = \"my-image-${local.timestamp}\"\n  instance_defined_tags_json = jsonencode({\n    \"Operations\" = {\n      \"Environment\" = \"prod\"\n      \"Team\"        = \"CostCenter\"\n    }\n  })\n  instance_name = \"packer-build-${local.timestamp}\"\n  instance_tags = {\n    testing = \"yes\"\n  }\n  shape       = \"VM.Standard.E2.1\"\n  subnet_ocid = \"ocid1.subnet.oc1.iad.aaa\"\n  tags = {\n    CreationDate = \"${legacy_isotime(\"20060102 03:04:05 MST\")}\"\n  }\n  use_private_ip = \"true\"\n}\n\nbuild {\n  sources = [\"source.oracle-oci.base-image-example\"]\n}\n```\n\n**JSON**\n\n```json\n{\n  \"variables\": {\n    \"timestamp\": \"{{isotime `20060102030405`}}\"\n  },\n  \"builders\":[{\n    \"name\": \"base-image-example\",\n    \"type\": \"oracle-oci\",\n    \"availability_domain\": \"aaaa:PHX-AD-1\",\n    \"base_image_ocid\": \"ocid1.image.oc1.iad.aaa\",\n    \"compartment_ocid\": \"ocid1.compartment.oc1..aaa\",\n    \"image_name\": \"my-image-{{ user `timestamp` }}\",\n    \"shape\": \"VM.Standard.E2.1\",\n    \"subnet_ocid\": \"ocid1.subnet.oc1.iad.aaa\",\n    \"use_private_ip\": \"true\",\n    \"instance_name\": \"packer-build-{{ user `timestamp` }}\",\n    \"instance_tags\": { \"testing\": \"yes\" },\n    \"instance_defined_tags\": {\n      \"Operations\": {\n        \"Team\": \"CostCenter\",\n        \"Environment\": \"prod\"\n      }\n    },\n    \"create_vnic_details\": {\n      \"assign_public_ip\": \"false\",\n      \"display_name\": \"testing-123\",\n      \"nsg_ids\": [\"ocid1.networksecuritygroup.oc1.iad.aaa\"]\n    },\n    \"tags\": {\n      \"CreationDate\": \"{{isotime `20060102 03:04:05 MST`}}\"\n    }\n  }]\n}\n```\n\n\n\n## Base Image Filter Example\n\nNote that `base_image_filter` gets passed as a string, then interpreted as a\nregular expression. This means that all back-slashes must be doubled, e.g.,\nuse `\\\\w+` to mean `\\w+`, and `\\\\\\\\` to create the regular expression equivalent\nof `\\\\` (which will search for a literal back-slash).\n\n```json\n{\n  \"name\":                \"base-image-{{isotime \\\"20060102030405\\\"}}\",\n  \"type\":                \"oracle-oci\",\n  \"availability_domain\": \"aaaa:PHX-AD-1\",\n  \"base_image_filter\": {\n    \"operating_system\": \"Oracle Linux\",\n    \"operating_system_version\": \"7.8\",\n    \"display_name_search\": \"^Oracle-Linux-7\\\\.8-2020\\\\.\\\\d+\"\n  }\n  ...\n}\n```\n","created_at":"2024-03-06T21:44:31.132Z","updated_at":"2024-03-06T21:44:31.132Z","name":"Oracle Cloud Infrastructure","slug":"oci","component":{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:30.937Z","updated_at":"2022-11-09T22:56:30.937Z"},"variable_groups":[]},{"id":"01c289dc-e546-4143-97d7-c95c02509641","integration_release_id":"84bab319-33fd-40e6-ae3d-6d43ad66e5bb","component_id":"36076511-3ced-4faf-addf-101fce0405ff","readme":"Type: `oracle-classic`\nArtifact BuilderId: `packer.oracle.classic`\n\nThe `oracle-classic` Packer builder is able to create custom images for use\nwith [Oracle Cloud Infrastructure Classic\nCompute](https://cloud.oracle.com/compute-classic). The builder takes a base\nimage, runs any provisioning necessary on the base image after launching it,\nand finally snapshots it creating a reusable custom image.\n\nIt is recommended that you familiarise yourself with the [Key Concepts and\nTerminology](https://docs.oracle.com/en/cloud/iaas-classic/compute-iaas-cloud/stcsg/getting-started-oracle-compute-cloud-service.html#GUID-6CB9D494-4F3C-4B78-BD03-127983FEC357)\nprior to using this builder if you have not done so already.\n\nThe builder _does not_ manage images. Once it creates an image, it is up to you\nto use it or delete it.\n\n## Configuration Reference\n\nThere are many configuration options available for the `oracle-classic`\nbuilder. This builder currently only works with the SSH communicator.\n\n### Required\n\n- `api_endpoint` (string) - This is your custom API endpoint for sending\n  requests. Instructions for determining your API endpoint can be found\n  [here](https://docs.oracle.com/en/cloud/iaas/compute-iaas-cloud/stcsa/SendRequests.html)\n\n- `dest_image_list` (string) - Where to save the machine image to once you've\n  provisioned it. If the provided image list does not exist, Packer will\n  create it.\n\n- `identity_domain` (string) - This is your customer-specific identity domain\n  as generated by Oracle. If you don't know what your identity domain is, ask\n  your account administrator. For a little more information, see the Oracle\n  [documentation](https://docs.oracle.com/en/cloud/get-started/subscriptions-cloud/ocuid/identity-domain-overview.html#GUID-7969F881-5F4D-443E-B86C-9044C8085B8A).\n\n- `source_image_list` (string) - This is what image you want to use as your\n  base image. See the\n  [documentation](https://docs.oracle.com/en/cloud/iaas-classic/compute-iaas-cloud/stcsg/managing-machine-images.html#GUID-652E6797-A5B8-40A7-860F-F27FF3E42471)\n  for more details. You may use either a public image list, or a private\n  image list. To see what public image lists are available, you can use the\n  CLI, as described\n  [here](https://docs.oracle.com/en/cloud/iaas/compute-iaas-cloud/stopc/image-lists-stclr-and-nmcli.html#GUID-DB7E75FE-F752-4FF7-AB70-3C8DCDFCA0FA)\n\n- `source_image_list_entry` (string) - The entry identifying the machine\n  image to use in the image list. Defaults to the latest available entry.\n\n- `password` (string) - Your account password.\n\n- `shape` (string) - The template that determines the number of CPUs, amount\n  of memory, and other resources allocated to a newly created instance. For\n  more information about shapes, see the documentation\n  [here](https://docs.oracle.com/en/cloud/iaas-classic/compute-iaas-cloud/stcsg/creating-instances.html#GUID-1DD0FA71-AC7B-461C-B8C1-14892725AA69).\n\n- `username` (string) - Your account username.\n\n### Optional\n\n- `attributes` (string) - (string) - Attributes to apply when launching the\n  instance. Note that you need to be careful about escaping characters due to\n  the templates being JSON. It is often more convenient to use\n  `attributes_file`, instead. You may only define either `attributes` or\n  `attributes_file`, not both.\n\n- `attributes_file` (string) - Path to a json file that will be used for the\n  attributes when launching the instance. You may only define either\n  `attributes` or `attributes_file`, not both.\n\n- `image_description` (string) - a description for your destination image\n  list. If you don't provide one, Packer will provide a generic description.\n\n- `ssh_username` (string) - The username that Packer will use to SSH into the\n  instance; required if using SSH. The default oracle user with sudo\n  privileges is `opc`, so you may set `ssh_username` to `opc` if you have not\n  yet configured users on your machine. If you have already configured users\n  on your machine, you may prompt Packer to use one of those instead. For\n  more detail, see the\n  [documentation](https://docs.oracle.com/en/cloud/iaas/compute-iaas-cloud/stcsg/accessing-oracle-linux-instance-using-ssh.html).\n\n- `image_name` (string) - The name to assign to the resulting custom image.\n\n- `persistent_volume_size` (int) - Size in gigabytes of the persistent boot\n  storage volume to build the image on. Use this if you want a bigger volume\n  than what instance storage provides. Note that using this option puts the\n  builder into a \"persistent volume\" mode, which is substantially different\n  than the default snapshot mode. Please see the configuration section below\n  for additional configuration options.\n\n- `snapshot_timeout` (string) - How long to wait for a snapshot to be\n  created. Expects a positive golang Time.Duration string, which is a\n  sequence of decimal numbers and a unit suffix; valid suffixes are `ns`\n  (nanoseconds), `us` (microseconds), `ms` (milliseconds), `s` (seconds), `m`\n  (minutes), and `h` (hours). Examples of valid inputs: `100ms`, `250ms`,\n  `1s`, `2.5s`, `2.5m`, `1m30s`. Example: `\"snapshot_timeout\": \"15m\"`.\n  Default: `20m`.\n\n### Persistent Volume Build\n\nYou will use this type of build if you've set the `persistent_volume_size`\noption. If you need a bigger disk than what you normally get with instance\nstorage, you'll want to set this.\n\nIn the _persistent volume_ mode, things are built a little differently.\nNormally, we launch an instance, then provision it and take a snapshot, which\nbecomes your machine image. This relies on the disk of the created instance\nbeing large enough to perform your entire provisioning process. If that disk\nsize isn't sufficient, we can build with a persistent volume of arbitrary size.\n\nFirst, we create a persistent volume of the requested size. This volume is\nbootable and initialized with your image list. We start an instance with this\nvolume as the boot volume. After this instance launches, we provision and\nterminate it, leaving the persistent volume around.\n\nNext, we create a second instance, the \"builder\", this time booting from\ninstance storage. We also attach a new persistent volume, making it twice the\nsize of the original. We connect to this instance and copy the contents of the\nfirst volume into a tarball file on the second volume. We then upload this file\nto Object Storage Classic, and create a new machine image with it.\n\nIf this is set, a few more options become available.\n\n- `builder_communicator` (communicator) - This represents an\n  [`ssh communicator`](/packer/docs/communicators/ssh),\n  and can be configured as such. If you use a different builder image, you\n  may need to change the `ssh_username`, for example. That might look like\n  this:\n\n  ```json\n  {\n    \"builders\": [\n      {\n        \"builder_communicator\": {\n          \"ssh_username\": \"soandso\"\n        },\n        \"type\": \"oracle-classic\"\n      }\n    ]\n  }\n  ```\n\n  See below for more details on configuring this communicator.\n\n- `builder_image_list` (string) - This is the image to use for the builder\n  instance. This _must_ be a linux image, and Oracle Linux is recommended.\n  Default: `/oracle/public/OL_7.2_UEKR4_x86_64`.\n\n- `builder_image_list_entry` (string) - The entry identifying the machine\n  image to use in the image list. If `builder_image_list` is unset, this\n  defaults to `5`, which is a working image as of this time. Otherwise, it\n  defaults to the latest entry. Set this to `0` to force it to use the latest\n  entry when using the default `builder_image_list`.\n\n- `builder_shape` (string) - The template that determines the number of CPUs,\n  amount of memory, and other resources allocated to the builder instance.\n  Default: `oc3`.\n\n- `builder_upload_image_command` (string) - The command to run to upload the\n  image to Object Storage Classic. This is for advanced users only, and you\n  should consult the default in code to decide on the changes to make. For\n  most users the default should suffice. If you choose to write your own,\n  this command is a template engine and can make use of the following\n  variables: `{{ .Username }}`, `{{ .Password }}`, `{{ .AccountID }}`,\n  `{{ .ImageFile }}`, and `{{ .SegmentPath }}`.\n\n### Communicator Configuration\n\nThe `builder_communicator` has the following options:\n\n#### Optional:\n\n<!-- Code generated from the comments of the Config struct in communicator/config.go; DO NOT EDIT MANUALLY -->\n\n- `communicator` (string) - Packer currently supports three kinds of communicators:\n  \n  -   `none` - No communicator will be used. If this is set, most\n      provisioners also can't be used.\n  \n  -   `ssh` - An SSH connection will be established to the machine. This\n      is usually the default.\n  \n  -   `winrm` - A WinRM connection will be established.\n  \n  In addition to the above, some builders have custom communicators they\n  can use. For example, the Docker builder has a \"docker\" communicator\n  that uses `docker exec` and `docker cp` to execute scripts and copy\n  files.\n\n- `pause_before_connecting` (duration string | ex: \"1h5m2s\") - We recommend that you enable SSH or WinRM as the very last step in your\n  guest's bootstrap script, but sometimes you may have a race condition\n  where you need Packer to wait before attempting to connect to your\n  guest.\n  \n  If you end up in this situation, you can use the template option\n  `pause_before_connecting`. By default, there is no pause. For example if\n  you set `pause_before_connecting` to `10m` Packer will check whether it\n  can connect, as normal. But once a connection attempt is successful, it\n  will disconnect and then wait 10 minutes before connecting to the guest\n  and beginning provisioning.\n\n<!-- End of code generated from the comments of the Config struct in communicator/config.go; -->\n\n\n<!-- Code generated from the comments of the SSH struct in communicator/config.go; DO NOT EDIT MANUALLY -->\n\n- `ssh_host` (string) - The address to SSH to. This usually is automatically configured by the\n  builder.\n\n- `ssh_port` (int) - The port to connect to SSH. This defaults to `22`.\n\n- `ssh_username` (string) - The username to connect to SSH with. Required if using SSH.\n\n- `ssh_password` (string) - A plaintext password to use to authenticate with SSH.\n\n- `ssh_ciphers` ([]string) - This overrides the value of ciphers supported by default by Golang.\n  The default value is [\n    \"aes128-gcm@openssh.com\",\n    \"chacha20-poly1305@openssh.com\",\n    \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\",\n  ]\n  \n  Valid options for ciphers include:\n  \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\", \"aes128-gcm@openssh.com\",\n  \"chacha20-poly1305@openssh.com\",\n  \"arcfour256\", \"arcfour128\", \"arcfour\", \"aes128-cbc\", \"3des-cbc\",\n\n- `ssh_clear_authorized_keys` (bool) - If true, Packer will attempt to remove its temporary key from\n  `~/.ssh/authorized_keys` and `/root/.ssh/authorized_keys`. This is a\n  mostly cosmetic option, since Packer will delete the temporary private\n  key from the host system regardless of whether this is set to true\n  (unless the user has set the `-debug` flag). Defaults to \"false\";\n  currently only works on guests with `sed` installed.\n\n- `ssh_key_exchange_algorithms` ([]string) - If set, Packer will override the value of key exchange (kex) algorithms\n  supported by default by Golang. Acceptable values include:\n  \"curve25519-sha256@libssh.org\", \"ecdh-sha2-nistp256\",\n  \"ecdh-sha2-nistp384\", \"ecdh-sha2-nistp521\",\n  \"diffie-hellman-group14-sha1\", and \"diffie-hellman-group1-sha1\".\n\n- `ssh_certificate_file` (string) - Path to user certificate used to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_pty` (bool) - If `true`, a PTY will be requested for the SSH connection. This defaults\n  to `false`.\n\n- `ssh_timeout` (duration string | ex: \"1h5m2s\") - The time to wait for SSH to become available. Packer uses this to\n  determine when the machine has booted so this is usually quite long.\n  Example value: `10m`.\n  This defaults to `5m`, unless `ssh_handshake_attempts` is set.\n\n- `ssh_disable_agent_forwarding` (bool) - If true, SSH agent forwarding will be disabled. Defaults to `false`.\n\n- `ssh_handshake_attempts` (int) - The number of handshakes to attempt with SSH once it can connect.\n  This defaults to `10`, unless a `ssh_timeout` is set.\n\n- `ssh_bastion_host` (string) - A bastion host to use for the actual SSH connection.\n\n- `ssh_bastion_port` (int) - The port of the bastion host. Defaults to `22`.\n\n- `ssh_bastion_agent_auth` (bool) - If `true`, the local SSH agent will be used to authenticate with the\n  bastion host. Defaults to `false`.\n\n- `ssh_bastion_username` (string) - The username to connect to the bastion host.\n\n- `ssh_bastion_password` (string) - The password to use to authenticate with the bastion host.\n\n- `ssh_bastion_interactive` (bool) - If `true`, the keyboard-interactive used to authenticate with bastion host.\n\n- `ssh_bastion_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with the\n  bastion host. The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_bastion_certificate_file` (string) - Path to user certificate used to authenticate with bastion host.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_file_transfer_method` (string) - `scp` or `sftp` - How to transfer files, Secure copy (default) or SSH\n  File Transfer Protocol.\n  \n  **NOTE**: Guests using Windows with Win32-OpenSSH v9.1.0.0p1-Beta, scp\n  (the default protocol for copying data) returns a a non-zero error code since the MOTW\n  cannot be set, which cause any file transfer to fail. As a workaround you can override the transfer protocol\n  with SFTP instead `ssh_file_transfer_protocol = \"sftp\"`.\n\n- `ssh_proxy_host` (string) - A SOCKS proxy host to use for SSH connection\n\n- `ssh_proxy_port` (int) - A port of the SOCKS proxy. Defaults to `1080`.\n\n- `ssh_proxy_username` (string) - The optional username to authenticate with the proxy server.\n\n- `ssh_proxy_password` (string) - The optional password to use to authenticate with the proxy server.\n\n- `ssh_keep_alive_interval` (duration string | ex: \"1h5m2s\") - How often to send \"keep alive\" messages to the server. Set to a negative\n  value (`-1s`) to disable. Example value: `10s`. Defaults to `5s`.\n\n- `ssh_read_write_timeout` (duration string | ex: \"1h5m2s\") - The amount of time to wait for a remote command to end. This might be\n  useful if, for example, packer hangs on a connection after a reboot.\n  Example: `5m`. Disabled by default.\n\n- `ssh_remote_tunnels` ([]string) - \n\n- `ssh_local_tunnels` ([]string) - \n\n<!-- End of code generated from the comments of the SSH struct in communicator/config.go; -->\n\n\n- `ssh_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the home directory\n  of current user.\n\n\n## Basic Example\n\nHere is a basic example. Note that account specific configuration has been\nobfuscated; you will need to add a working `username`, `password`,\n`identity_domain`, and `api_endpoint` in order for the example to work.\n\n**HCL2**\n\n```hcl\nlocals { timestamp = regex_replace(timestamp(), \"[- TZ:]\", \"\") }\n\nsource \"oracle-classic\" \"basic\" {\n  api_endpoint      = \"https://api-###.compute.###.oraclecloud.com/\"\n  attributes        = \"{\\\"userdata\\\": {\\\"pre-bootstrap\\\": {\\\"script\\\": [\\\"...\\\"]}}}\"\n  dest_image_list   = \"Packer_Builder_Test_List\"\n  identity_domain   = \"#######\"\n  image_name        = \"Packer_Builder_Test_${local.timestamp}\"\n  password          = \"supersecretpasswordhere\"\n  shape             = \"oc3\"\n  source_image_list = \"/oracle/public/OL_7.2_UEKR4_x86_64\"\n  username          = \"myuser@myaccount.com\"\n}\n\nbuild {\n  sources = [\"source.oracle-classic.basic\"]\n\n  provisioner \"shell\" {\n    inline = [\"echo hello\"]\n  }\n\n}\n```\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"oracle-classic\",\n      \"username\": \"myuser@myaccount.com\",\n      \"password\": \"supersecretpasswordhere\",\n      \"identity_domain\": \"#######\",\n      \"api_endpoint\": \"https://api-###.compute.###.oraclecloud.com/\",\n      \"source_image_list\": \"/oracle/public/OL_7.2_UEKR4_x86_64\",\n      \"shape\": \"oc3\",\n      \"image_name\": \"Packer_Builder_Test_{{timestamp}}\",\n      \"attributes\": \"{\\\"userdata\\\": {\\\"pre-bootstrap\\\": {\\\"script\\\": [\\\"...\\\"]}}}\",\n      \"dest_image_list\": \"Packer_Builder_Test_List\"\n    }\n  ],\n  \"provisioners\": [\n    {\n      \"type\": \"shell\",\n      \"inline\": [\"echo hello\"]\n    }\n  ]\n}\n```\n\n\n\n## Basic Example -- Windows\n\nAttributes file is optional for connecting via ssh, but required for winrm.\n\nThe following file contains the bare minimum necessary to get winRM working;\nyou have to give it the password to give to the \"Administrator\" user, which\nwill be the one winrm connects to. You must also whitelist your computer to\nconnect via winRM -- the empty braces below whitelist any computer to access\nwinRM but you can make it more secure by only allowing your build machine\naccess. See the\n[docs](https://docs.oracle.com/en/cloud/iaas/compute-iaas-cloud/stcsg/automating-instance-initialization-using-opc-init.html#GUID-A0A107D6-3B38-47F4-8FC8-96D50D99379B)\nfor more details on how to define a trusted host.\n\nSave this file as `windows_attributes.json`:\n\n```json\n{\n  \"userdata\": {\n    \"administrator_password\": \"password\",\n    \"winrm\": {}\n  }\n}\n```\n\nFollowing is a minimal but working Packer config that references this\nattributes file:\n\n**HCL2**\n\n```hcl\n\nvariable \"opc_api_endpoint\" {\n  type    = string\n  default = \"${env(\"OPC_ENDPOINT\")}\"\n}\n\nvariable \"opc_identity_domain\" {\n  type    = string\n  default = \"${env(\"OPC_IDENTITY_DOMAIN\")}\"\n}\n\nvariable \"opc_password\" {\n  type    = string\n  default = \"${env(\"OPC_PASSWORD\")}\"\n}\n\nvariable \"opc_username\" {\n  type    = string\n  default = \"${env(\"OPC_USERNAME\")}\"\n}\n\nlocals { timestamp = regex_replace(timestamp(), \"[- TZ:]\", \"\") }\n\nsource \"oracle-classic\" \"windows_attrs\" {\n  api_endpoint      = \"${var.opc_api_endpoint}\"\n  attributes_file   = \"./windows_attributes.json\"\n  communicator      = \"winrm\"\n  dest_image_list   = \"Packer_Windows_Demo\"\n  identity_domain   = \"${var.opc_identity_domain}\"\n  image_name        = \"Packer_Windows_Demo_${local.timestamp}\"\n  password          = \"${var.opc_password}\"\n  shape             = \"oc3\"\n  source_image_list = \"/Compute-${var.opc_identity_domain}/${var.opc_username}/Microsoft_Windows_Server_2012_R2-17.3.6-20170930-124649\"\n  username          = \"${var.opc_username}\"\n  winrm_password    = \"password\"\n  winrm_username    = \"Administrator\"\n}\n\nbuild {\n  sources = [\"source.oracle-classic.windows_attrs\"]\n\n  provisioner \"powershell\" {\n    inline = \"Write-Output(\\\"HELLO WORLD\\\")\"\n  }\n\n}\n\n```\n\n**JSON**\n\n```json\n{\n  \"variables\": {\n    \"opc_username\": \"{{ env `OPC_USERNAME`}}\",\n    \"opc_password\": \"{{ env `OPC_PASSWORD`}}\",\n    \"opc_identity_domain\": \"{{env `OPC_IDENTITY_DOMAIN`}}\",\n    \"opc_api_endpoint\": \"{{ env `OPC_ENDPOINT`}}\"\n  },\n  \"builders\": [\n    {\n      \"type\": \"oracle-classic\",\n      \"username\": \"{{ user `opc_username`}}\",\n      \"password\": \"{{ user `opc_password`}}\",\n      \"identity_domain\": \"{{ user `opc_identity_domain`}}\",\n      \"api_endpoint\": \"{{ user `opc_api_endpoint`}}\",\n      \"source_image_list\": \"/Compute-{{ user `opc_identity_domain` }}/{{ user `opc_username`}}/Microsoft_Windows_Server_2012_R2-17.3.6-20170930-124649\",\n      \"attributes_file\": \"./windows_attributes.json\",\n      \"shape\": \"oc3\",\n      \"image_name\": \"Packer_Windows_Demo_{{timestamp}}\",\n      \"dest_image_list\": \"Packer_Windows_Demo\",\n      \"communicator\": \"winrm\",\n      \"winrm_username\": \"Administrator\",\n      \"winrm_password\": \"password\"\n    }\n  ],\n  \"provisioners\": [\n    {\n      \"type\": \"powershell\",\n      \"inline\": \"Write-Output(\\\"HELLO WORLD\\\")\"\n    }\n  ]\n}\n```\n\n\n## Persistent Volume Example\n\nHere is an example using a persistent volume. Note the `persistent_volume_size`\nsetting.\n\n**HCL2**\n\n```hcl\n\nvariable \"opc_api_endpoint\" {\n  type    = string\n  default = \"${env(\"OPC_ENDPOINT\")}\"\n}\n\nvariable \"opc_identity_domain\" {\n  type    = string\n  default = \"${env(\"OPC_IDENTITY_DOMAIN\")}\"\n}\n\nvariable \"opc_password\" {\n  type    = string\n  default = \"${env(\"OPC_PASSWORD\")}\"\n}\n\nvariable \"opc_username\" {\n  type    = string\n  default = \"${env(\"OPC_USERNAME\")}\"\n}\n\nlocals { timestamp = regex_replace(timestamp(), \"[- TZ:]\", \"\") }\n\nsource \"oracle-classic\" \"persistent\" {\n  api_endpoint           = \"${var.opc_api_endpoint}\"\n  dest_image_list        = \"Packer_Builder_Test_List\"\n  identity_domain        = \"${var.opc_identity_domain}\"\n  image_name             = \"Packer_Builder_Test_${local.timestamp}\"\n  password               = \"${var.opc_password}\"\n  persistent_volume_size = 15\n  shape                  = \"oc3\"\n  source_image_list      = \"/oracle/public/OL_7.2_UEKR4_x86_64\"\n  ssh_username           = \"opc\"\n  username               = \"${var.opc_username}\"\n}\n\nbuild {\n  sources = [\"source.oracle-classic.persistent\"]\n\n  provisioner \"shell\" {\n    inline = [\"echo hello\"]\n  }\n\n}\n\n```\n\n**JSON**\n\n```json\n{\n  \"variables\": {\n    \"opc_username\": \"{{ env `OPC_USERNAME`}}\",\n    \"opc_password\": \"{{ env `OPC_PASSWORD`}}\",\n    \"opc_identity_domain\": \"{{env `OPC_IDENTITY_DOMAIN`}}\",\n    \"opc_api_endpoint\": \"{{ env `OPC_ENDPOINT`}}\"\n  },\n  \"builders\": [\n    {\n      \"type\": \"oracle-classic\",\n      \"username\": \"{{ user `opc_username`}}\",\n      \"password\": \"{{ user `opc_password`}}\",\n      \"identity_domain\": \"{{ user `opc_identity_domain`}}\",\n      \"api_endpoint\": \"{{ user `opc_api_endpoint`}}\",\n      \"source_image_list\": \"/oracle/public/OL_7.2_UEKR4_x86_64\",\n      \"persistent_volume_size\": 15,\n      \"image_name\": \"Packer_Builder_Test_{{timestamp}}\",\n      \"dest_image_list\": \"Packer_Builder_Test_List\",\n      \"ssh_username\": \"opc\",\n      \"shape\": \"oc3\"\n    }\n  ],\n  \"provisioners\": [\n    {\n      \"type\": \"shell\",\n      \"inline\": [\"echo hello\"]\n    }\n  ]\n}\n```\n","created_at":"2024-03-06T21:44:31.241Z","updated_at":"2024-03-06T21:44:31.241Z","name":"Oracle Cloud Infrastructure Classic Compute","slug":"classic","component":{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:30.937Z","updated_at":"2022-11-09T22:56:30.937Z"},"variable_groups":[]}]},"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Packer","url":"/packer"},{"title":"Integrations","url":"/packer/integrations"},{"title":"Oracle","url":"/packer/integrations/hashicorp/oracle","isCurrentPage":true}],"anchorLinks":[{"id":"installation","level":2,"title":"Installation"},{"id":"components","level":2,"title":"Components"},{"id":"builders","level":3,"title":"Builders"},{"id":"oracle-classic-authentication","level":2,"title":"Oracle Classic Authentication"},{"id":"oracle-oci-authentication","level":2,"title":"Oracle OCI Authentication"},{"id":"policy-reference","level":3,"title":"Policy Reference"},{"id":"api-signing-key","level":3,"title":"API Signing Key"},{"id":"instance-principal","level":3,"title":"Instance Principal"},{"id":"security-token","level":3,"title":"Security Token"}],"serializedREADME":{"compiledSource":"const layoutProps={};const MDXLayout=\"wrapper\";function MDXContent({components,...props}){return mdx(MDXLayout,{...layoutProps,...props,components:components,mdxType:\"MDXLayout\"},mdx(\"p\",{\"className\":\"g-type-long-body\"},`This plugin allows Packer to communicate with the Oracle cloud platform.\nIt is able to create custom images on both Oracle Cloud Infrastructure and\nOracle Cloud Infrastructure Classic Compute. This plugin comes with builders\ndesigned to support both platforms.`),mdx(\"h2\",{\"id\":\"user-content-installation\",\"data-text-content\":\"Installation\",\"className\":\"g-type-display-3\"},`Installation`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`To install this plugin, copy and paste this code into your Packer configuration, then run `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.packer.io/docs/commands/init\"},mdx(\"inlineCode\",{parentName:\"a\"},`packer init`)),`.`),mdx(\"pre\",{\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},`packer`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},`required_plugins`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`oracle`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`source`),`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"github.com/hashicorp/oracle\"`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`version`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"~> 1\"`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Alternatively, you can use `,mdx(\"inlineCode\",{parentName:\"p\"},`packer plugins install`),` to manage installation of this plugin.`),mdx(\"pre\",{\"className\":\"language-sh\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-sh\"},`$ packer plugins install github.com/hashicorp/oracle`,`\n`)),mdx(\"h2\",{\"id\":\"user-content-components\",\"data-text-content\":\"Components\",\"className\":\"g-type-display-3\"},`Components`),mdx(\"h3\",{\"id\":\"user-content-builders\",\"data-text-content\":\"Builders\",\"className\":\"g-type-display-4\"},`Builders`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/integrations/hashicorp/oracle/latest/components/builder/oci\"},`oracle-classic`),` - Create custom images in Oracle Cloud Infrastructure\nClassic Compute by launching a source instance and creating an image list from a snapshot of it after provisioning.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/integrations/hashicorp/oracle/latest/components/builder/classic\"},`oracle-oci`),` - Create custom images in Oracle Cloud Infrastructure (OCI) by\nlaunching a base instance and creating an image from it after provisioning.`))),mdx(\"h2\",{\"id\":\"user-content-oracle-classic-authentication\",\"data-text-content\":\"Oracle Classic Authentication\",\"className\":\"g-type-display-3\"},`Oracle Classic Authentication`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`This builder authenticates API calls to Oracle Cloud Infrastructure Classic\nCompute using basic authentication (user name and password). To read more, see\nthe `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.oracle.com/en/cloud/iaas/compute-iaas-cloud/stcsa/Authentication.html\"},`authentication\ndocumentation`)),mdx(\"h2\",{\"id\":\"user-content-oracle-oci-authentication\",\"data-text-content\":\"Oracle OCI Authentication\",\"className\":\"g-type-display-3\"},`Oracle OCI Authentication`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`There are three authentication methods available for the OCI builder. The API\nSigning Key of the `,mdx(\"inlineCode\",{parentName:\"p\"},`DEFAULT`),` profile in the OCI\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.oracle.com/en-us/iaas/Content/API/Concepts/sdkconfig.htm#SDK_and_CLI_Configuration_File\"},`SDK and CLI Configuration File`),`\nwill be used by default.`),mdx(\"h3\",{\"id\":\"user-content-policy-reference\",\"data-text-content\":\"Policy Reference\",\"className\":\"g-type-display-4\"},`Policy Reference`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`When running the `,mdx(\"inlineCode\",{parentName:\"p\"},`oracle-oci`),` builder as a non-administrative user, you will need to have OCI policies defined which will enable Packer to do its job.  `),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The following represent minimal required policies for the plugin to operate:`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},`Allow group PackerGroup to manage instance-family in compartment \\${COMPARTMENT_NAME}`,`\n`,`Allow group PackerGroup to manage instance-images in compartment \\${COMPARTMENT_NAME}`,`\n`,`Allow group PackerGroup to use virtual-network-family in compartment \\${COMPARTMENT_NAME}`,`\n`,`Allow group PackerGroup to manage compute-image-capability-schema in tenancy`,`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`This example assumes the user running Packer is in a group named 'PackerGroup'.  You will need to update \\${COMPARTMENT_NAME} to the name of the\ncompartment in which the plugin is managing resources.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`For more details on working with OCI Policies, please refer to the `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.oracle.com/en-us/iaas/Content/Identity/policiesgs/get-started-with-policies.htm\"},`OCI Policy Documentation`)),mdx(\"h3\",{\"id\":\"user-content-api-signing-key\",\"data-text-content\":\"API Signing Key\",\"className\":\"g-type-display-4\"},`API Signing Key`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The OCI REST API requires that requests be signed with the RSA public key\nassociated with your\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.us-phoenix-1.oraclecloud.com/Content/Identity/Concepts/overview.htm\"},`IAM`),`\nuser account. For a comprehensive example of how to configure the required\nauthentication see the documentation on `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.us-phoenix-1.oraclecloud.com/Content/API/Concepts/apisigningkey.htm\"},`Required Keys and\nOCIDs`),`\n(`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.us-phoenix-1.oraclecloud.com/Content/General/Concepts/identifiers.htm\"},`Oracle Cloud\nIDs`),`).`),mdx(\"h3\",{\"id\":\"user-content-instance-principal\",\"data-text-content\":\"Instance Principal\",\"className\":\"g-type-display-4\"},`Instance Principal`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`If you run Packer on an OCI compute instance, you can configure Packer to use the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.cloud.oracle.com/en-us/iaas/Content/Identity/Tasks/callingservicesfrominstances.htm\"},`Instance Principal`),`\nassociated with that instance to authenticate instead of an API Signing Key that\nis associated with a specific user. This method requires the creation of appropriately configured\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingdynamicgroups.htm\"},`Dynamic Groups`),`\nand `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm\"},`Policies`),`.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.packer.io/docs/builders/oracle/oci#use_instance_principals\"},mdx(\"inlineCode\",{parentName:\"a\"},`use_instance_principals`)),`\nparameter is used to enable this method.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The `,mdx(\"a\",{parentName:\"p\",\"href\":\"/example/oci_instance_principals.pkr.hcl\"},mdx(\"inlineCode\",{parentName:\"a\"},`oci_instance_principals.pkr.hcl`)),`\nand `,mdx(\"a\",{parentName:\"p\",\"href\":\"/example/oci_instance_principals.json\"},mdx(\"inlineCode\",{parentName:\"a\"},`oci_instance_principals.json`)),` examples can be used as a reference for\nconfiguring this authentication method.`),mdx(\"h3\",{\"id\":\"user-content-security-token\",\"data-text-content\":\"Security Token\",\"className\":\"g-type-display-4\"},`Security Token`),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.oracle.com/en-us/iaas/Content/API/SDKDocs/clitoken.htm\"},`Token-based authentication`),`\nrequires you to interactively authenticate a session using the OCI CLI and a web\nbrowser. The token that is created has an extremely limited TTL and must be\nrefreshed every hour for up to 24 hours. However, this method allows for\nauthentication using non-SCIM supported federated identity providers.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`To use token-based authentication, start a new session using the CLI's\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.oracle.com/en-us/iaas/Content/API/SDKDocs/clitoken.htm#Starting\"},mdx(\"inlineCode\",{parentName:\"a\"},`oci session authenticate`)),`\ncommand and provide the path to the configuration file as the `,mdx(\"inlineCode\",{parentName:\"p\"},`access_cfg_file`),`\nconfiguration parameter and the name of the profile as the `,mdx(\"inlineCode\",{parentName:\"p\"},`access_cfg_file_account`),`\nconfiguration parameter.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The `,mdx(\"a\",{parentName:\"p\",\"href\":\"/example/oci_security_token.pkr.hcl\"},mdx(\"inlineCode\",{parentName:\"a\"},`oci_security_token.pkr.hcl`)),` and\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"/example/oci_security_token.json\"},mdx(\"inlineCode\",{parentName:\"a\"},`oci_security_token.json`)),` examples can be\nused as a reference for this method.`))};MDXContent.isMDXComponent=true;","scope":{}}},"__N_SSG":true}