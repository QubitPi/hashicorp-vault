"use strict";(()=>{var e={};e.id=3748,e.ids=[3748],e.modules={33666:e=>{e.exports=require("@vercel/fetch")},73227:e=>{e.exports=require("next-auth")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},84269:e=>{e.exports=require("url")},16064:e=>{e.exports=import("@vercel/edge-config")},56249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},7692:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{config:()=>d,default:()=>u,routeModule:()=>l});var o=r(71802),s=r(47153),a=r(56249),i=r(11922),c=e([i]);i=(c.then?(await c)():c)[0];let u=(0,a.l)(i,"default"),d=(0,a.l)(i,"config"),l=new o.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/auth/[...nextauth]",pathname:"/api/auth/[...nextauth]",bundlePath:"",filename:""},userland:i});n()}catch(e){n(e)}})},63930:(e,t,r)=>{r.d(t,{Z:()=>n});let n={id:r(89424).I.CloudIdp,name:"Cloud IDP",type:"oauth",wellKnown:"https://auth.idp.hcp.dev/.well-known/openid-configuration",authorization:{params:{scope:"openid offline_access"}},idToken:!0,checks:["pkce","state"],clientId:process.env.AUTH_CLIENT_ID,clientSecret:process.env.AUTH_CLIENT_SECRET,client:{name:"HashiCorp Developer",token_endpoint_auth_method:"client_secret_post"},profile:e=>({id:e.sub,...e})}},27559:(e,t,r)=>{r.d(t,{Z:()=>o});let n=require("jsonwebtoken");function o(e){let t=Date.now()/1e3,r=(0,n.decode)(e,{json:!0});if(!r)throw Error("isJwtExpired failed to parse jwt");let{exp:o}=r;return[t>o,Math.floor(o-t)]}},28439:(e,t,r)=>{r.d(t,{Z:()=>n});async function n(e){try{let t=new URL("/oauth2/token","https://auth.idp.hcp.dev"),r=await fetch(t.toString(),{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:new URLSearchParams({client_id:process.env.AUTH_CLIENT_ID,client_secret:process.env.AUTH_CLIENT_SECRET,grant_type:"refresh_token",refresh_token:e})}),n=await r.json();if(!r.ok)throw n;return n}catch(e){throw console.log("refreshTokenSet error",e),e}}},11922:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{default:()=>k});var o=r(33666),s=r.n(o),a=r(73227),i=r.n(a),c=r(84269),u=r(89424),d=r(63930),l=r(28439),h=r(27559),p=r(16064),f=e([p]);p=(f.then?(await f)():f)[0];let _=s()(),k=i()({session:{maxAge:2592e3},events:{async signOut({token:e}){try{let t=(await (await _(d.Z.wellKnown)).json()).end_session_endpoint,r=new c.URL(t),n=e.id_token;r.searchParams.set("id_token_hint",n),await _(r.toString())}catch(e){console.error("[NextAuth] There was an error in the `signOut` event:",e)}}},providers:[d.Z],callbacks:{async jwt({token:e,account:t,profile:r}){if(t&&r)return e.access_token=t.access_token,e.refresh_token=t.refresh_token,e.id_token=t.id_token,e.picture=r.picture,e.nickname=r.nickname,e;let[n,o]=(0,h.Z)(e.access_token);if(n)try{let{access_token:t,refresh_token:r}=await (0,l.Z)(e.refresh_token);e.access_token=t,e.refresh_token=r}catch(t){return console.error(`${u.C.RefreshAccessTokenError}: failed to refresh token set`,t),{...e,error:u.C.RefreshAccessTokenError}}return e},async session({session:e,token:t}){let r=t.sub,n=!1;try{n=!!(await (0,p.get)("allowlist"))[r]}catch(e){}return{...e,accessToken:t.access_token,id:t.sub,user:{...e.user,nickname:t.nickname,id:t.sub},error:t.error,meta:{isAIEnabled:n}}}}});n()}catch(e){n(e)}})},89424:(e,t,r)=>{var n,o;r.d(t,{C:()=>o,I:()=>n}),(n||(n={})).CloudIdp="cloud-idp",function(e){e.RefreshAccessTokenError="[next-auth] RefreshAccessTokenError",e.RefreshAccessTokenExpiredError="[next-auth] RefreshAccessTokenError: token_inactive"}(o||(o={}))},47153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},71802:(e,t,r)=>{e.exports=r(20145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=t(t.s=7692);module.exports=r})();