{"pageProps":{"metadata":{"title":"Ceph | Integrations","description":"This pack deploys Ceph in demo mode"},"product":{"name":"Nomad","slug":"nomad","algoliaConfig":{"indexName":"product_NOMAD","searchOnlyApiKey":"9bfec34ea54e56a11bd50d6bfedc5e71"},"analyticsConfig":{"includedDomains":"nomadproject.io www.nomadproject.io","segmentWriteKey":"qW11yxgipKMsKFKQUCpTVgQUYftYsJj0"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Nomad by HashiCorp","description":"Nomad is a highly available, distributed, data-center aware cluster and application scheduler designed to support the modern datacenter with support for long-running services, batch jobs, and much more.","image":"https://www.nomadproject.io/nomad-public/img/og-image.png","icon":[{"href":"/nomad-public/_favicon.ico"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiConf","url":"https://hashiconf.com/2023?utm_source=direct&utm_medium=banner&utm_campaign=23Q3_HASHICONFGLOBAL_EVENT&utm_content=&utm_offer=event","text":"Our community conference is taking place in San Francisco and online October 10-12.","linkText":"Register now","expirationDate":""},"version":"1.2.5","subnavItems":[{"text":"Overview","url":"/","type":"inbound"},{"text":"Enterprise","url":"https://www.hashicorp.com/products/nomad/","type":"outbound"},"divider",{"text":"Tutorials","url":"https://developer.hashicorp.com/nomad/tutorials","type":"outbound"},{"text":"Docs","url":"/docs","type":"inbound"},{"text":"API","url":"/api-docs","type":"inbound"},{"text":"Plugins","url":"/plugins","type":"inbound"},{"text":"Tools","url":"/tools","type":"inbound"},{"text":"Community","url":"/community","type":"inbound"}],"basePaths":["docs","api-docs","plugins","tools","intro","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"entry-point","name":"Intro","path":"intro"},{"iconName":"api","name":"API","path":"api-docs"},{"iconName":"terminal-screen","name":"Tools","path":"tools"},{"iconName":"plug","name":"Plugins","path":"plugins"}],"integrationsConfig":{"description":"A curated collection of official, partner, and community Nomad Integrations."}},"integration":{"id":"670dd8a7-2168-4a56-99be-42579df872e8","slug":"ceph","name":"Ceph","description":"This pack deploys Ceph in demo mode","license_type":null,"license_url":null,"external_only":false,"external_url":"https://github.com/ceph/ceph-container","tier":"community","repo_url":"https://github.com/hashicorp/nomad-pack-community-registry","subdirectory":"/packs/ceph","created_at":"2023-06-26T21:37:19.000Z","updated_at":"2023-07-12T18:05:03.104Z","hide_versions":false,"organization":{"id":"a4a0551a-1451-4d89-9f56-8031c8350c77","slug":"hashicorp","created_at":"2022-11-09T22:56:32.391Z","updated_at":"2022-11-09T22:56:32.391Z"},"product":{"id":"40557cca-56ca-4cb2-abc6-9bba2a9ca62d","slug":"nomad","name":"Nomad","created_at":"2022-11-09T22:56:29.799Z","updated_at":"2022-11-09T22:56:29.799Z"},"versions":["0.1.0"],"components":[],"flags":[],"integration_type":{"id":"e8835871-6a6a-4836-8797-505cbfbe426a","product_id":"40557cca-56ca-4cb2-abc6-9bba2a9ca62d","slug":"pack","name":"Pack","plural_name":"Packs","description":"Packs are templated sets of resources that are meant to be deployed to Nomad together. Each pack defines parameters that can be customized by the end user.","created_at":"2023-05-02T17:31:29.062Z","updated_at":"2023-05-17T22:44:11.429Z"}},"activeRelease":{"id":"63b1a0ee-f26d-4ecd-843f-565d6b987fcf","integration_id":"670dd8a7-2168-4a56-99be-42579df872e8","version":"0.1.0","readme":"This pack deploys a Ceph container in \"demo\" mode, where a single\ncontainer runs all the required services. This is primarily for\ndemonstration purposes and to provide a target for the `ceph_rbd_csi`\npack.\n\n**NOTE:** This pack is not suitable for production, and if the\nallocation is rescheduled all data written to Ceph will be lost! If\nyou are intererested in submitting an update to make this Ceph pack\nproduction-ready, the Nomad engineering team would enthusiastically\nreview it!\n\n## Client Requirements\n\nThis pack can only be run on Nomad clients that have enabled volumes\nand privileged mode for the Docker task driver. In addition, you must\nhave the `rbd` kernel module loaded:\n\n```\n$ sudo modprobe rbd\n$ lsmod | grep rbd\nrbd                   106496  0\nlibceph               327680  1 rbd\n```\n\nWithout the kernel module loaded, plugins that consume Ceph will fail\nwith errors like: `modprobe: FATAL: Module rbd not found in directory`\n\n## Variables\n\n* `job_name` (string \"ceph\") - The name to use for the job.\n* `datacenters` (list(string) [\"dc1\"]) - A list of datacenters in the\n  region which are eligible for task placement.\n* `region` (string \"global\") - The region where the job should be\n  placed.\n* `ceph_image` (string \"ceph/daemon:latest-octopus\") - The container\n  image for Ceph.\n* `ceph_cluster_id` (string \"\") - The Ceph cluster ID (will default to\n  a random UUID).\n* `ceph_demo_uid` (string \"demo\") - The UID for the Ceph demo.\n* `ceph_demo_bucket` (string \"example\") - The bucket name for the Ceph demo.\n* `ceph_monitor_service_name` (string \"ceph-mon\") - The Consul service\n  name for the Ceph monitoring service.\n* `ceph_monitor_service_port` (number 3300) - The port for the Ceph\n  monitoring service to listen on.\n* `ceph_dashboard_service_name` (string \"ceph-dashboard\") - The Consul\n  service name for the Ceph dashboard service.\n* `ceph_dashboard_service_port` (number 5000) - The port for the Ceph\n  dashboard service to listen on.\n* `ceph_config_file` (string \"\") - The full text of the Ceph demo\n  configuration file. A reasonable demo will be provided by default.\n\n#### `constraints` List of Objects\n\n[Nomad job specification\nconstraints](https://www.nomadproject.io/docs/job-specification/constraint)\nallow restricting the set of eligible nodes on which the tasks will\nrun. This pack automatically configures the following required\nconstraints:\n\n* The task will run on Linux hosts only\n* The task will run on hosts with the Docker driver's\n  [`volumes`](https://www.nomadproject.io/docs/drivers/docker#volumes-1)\n  enabled and\n  [`allow_privileged`](https://www.nomadproject.io/docs/drivers/docker#allow_privileged)\n  set to `true`.\n\nYou can set additional constraints with the `constraints` variable,\nwhich takes a list of objects with the following fields:\n\n* `attribute` (string) - Specifies the name or reference of the\n  attribute to examine for the constraint.\n* `operator` (string) - Specifies the comparison operator. The\n  ordering is compared lexically.\n* `value` (string) - Specifies the value to compare the attribute\n  against using the specified operation.\n\nBelow is also an example of how to pass `constraints` to the CLI with\nwith the `-var` argument.\n\n```bash\nnomad-pack run -var 'constraints=[{\"attribute\":\"$${meta.my_custom_value}\",\"operator\":\">\",\"value\":\"3\"}]' packs/ceph\n```\n\n#### `resources` Object\n\n* `cpu` (number 256) - Specifies the CPU required to run this task in\n  MHz.\n* `memory` (number 600) - Specifies the memory required in MB.\n","created_at":"2023-06-26T21:46:48.079Z","updated_at":"2023-06-26T21:46:48.079Z","components":[]},"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Nomad","url":"/nomad"},{"title":"Integrations","url":"/nomad/integrations"},{"title":"Ceph","url":"/nomad/integrations/hashicorp/ceph","isCurrentPage":true}],"anchorLinks":[{"id":"client-requirements","level":2,"title":"Client Requirements"},{"id":"variables","level":2,"title":"Variables"},{"id":"constraints-list-of-objects","level":4,"title":"constraints List of Objects"},{"id":"resources-object","level":4,"title":"resources Object"}],"serializedREADME":{"compiledSource":"var c=Object.defineProperty,m=Object.defineProperties;var h=Object.getOwnPropertyDescriptors;var o=Object.getOwnPropertySymbols;var l=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;var s=(i,n,t)=>n in i?c(i,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[n]=t,e=(i,n)=>{for(var t in n||(n={}))l.call(n,t)&&s(i,t,n[t]);if(o)for(var t of o(n))r.call(n,t)&&s(i,t,n[t]);return i},p=(i,n)=>m(i,h(n));var d=(i,n)=>{var t={};for(var a in i)l.call(i,a)&&n.indexOf(a)<0&&(t[a]=i[a]);if(i!=null&&o)for(var a of o(i))n.indexOf(a)<0&&r.call(i,a)&&(t[a]=i[a]);return t};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var a=t,{components:i}=a,n=d(a,[\"components\"]);return mdx(MDXLayout,p(e(e({},layoutProps),n),{components:i,mdxType:\"MDXLayout\"}),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`This pack deploys a Ceph container in \"demo\" mode, where a single\ncontainer runs all the required services. This is primarily for\ndemonstration purposes and to provide a target for the `,mdx(\"inlineCode\",{parentName:\"p\"},\"ceph_rbd_csi\"),`\npack.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),` This pack is not suitable for production, and if the\nallocation is rescheduled all data written to Ceph will be lost! If\nyou are intererested in submitting an update to make this Ceph pack\nproduction-ready, the Nomad engineering team would enthusiastically\nreview it!`),mdx(\"h2\",e({},{id:\"user-content-client-requirements\",\"data-text-content\":\"Client Requirements\",className:\"g-type-display-3\"}),\"Client Requirements\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`This pack can only be run on Nomad clients that have enabled volumes\nand privileged mode for the Docker task driver. In addition, you must\nhave the `,mdx(\"inlineCode\",{parentName:\"p\"},\"rbd\"),\" kernel module loaded:\"),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},\"$ sudo modprobe rbd\",`\n`,\"$ lsmod | grep rbd\",`\n`,\"rbd                   106496  0\",`\n`,\"libceph               327680  1 rbd\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Without the kernel module loaded, plugins that consume Ceph will fail\nwith errors like: `,mdx(\"inlineCode\",{parentName:\"p\"},\"modprobe: FATAL: Module rbd not found in directory\")),mdx(\"h2\",e({},{id:\"user-content-variables\",\"data-text-content\":\"Variables\",className:\"g-type-display-3\"}),\"Variables\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"job_name\"),' (string \"ceph\") - The name to use for the job.'),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"datacenters\"),\" (list(string) \",'[\"dc1\"]',`) - A list of datacenters in the\nregion which are eligible for task placement.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"region\"),` (string \"global\") - The region where the job should be\nplaced.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"ceph_image\"),` (string \"ceph/daemon:latest-octopus\") - The container\nimage for Ceph.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"ceph_cluster_id\"),` (string \"\") - The Ceph cluster ID (will default to\na random UUID).`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"ceph_demo_uid\"),' (string \"demo\") - The UID for the Ceph demo.'),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"ceph_demo_bucket\"),' (string \"example\") - The bucket name for the Ceph demo.'),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"ceph_monitor_service_name\"),` (string \"ceph-mon\") - The Consul service\nname for the Ceph monitoring service.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"ceph_monitor_service_port\"),` (number 3300) - The port for the Ceph\nmonitoring service to listen on.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"ceph_dashboard_service_name\"),` (string \"ceph-dashboard\") - The Consul\nservice name for the Ceph dashboard service.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"ceph_dashboard_service_port\"),` (number 5000) - The port for the Ceph\ndashboard service to listen on.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"ceph_config_file\"),` (string \"\") - The full text of the Ceph demo\nconfiguration file. A reasonable demo will be provided by default.`)),mdx(\"h4\",e({},{id:\"user-content-constraints-list-of-objects\",\"data-text-content\":\"constraints List of Objects\",className:\"g-type-display-5\"}),mdx(\"inlineCode\",{parentName:\"h4\"},\"constraints\"),\" List of Objects\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"p\"},{href:\"https://www.nomadproject.io/docs/job-specification/constraint\"}),`Nomad job specification\nconstraints`),`\nallow restricting the set of eligible nodes on which the tasks will\nrun. This pack automatically configures the following required\nconstraints:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"The task will run on Linux hosts only\"),mdx(\"li\",{parentName:\"ul\"},`The task will run on hosts with the Docker driver's\n`,mdx(\"a\",e({parentName:\"li\"},{href:\"https://www.nomadproject.io/docs/drivers/docker#volumes-1\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"volumes\")),`\nenabled and\n`,mdx(\"a\",e({parentName:\"li\"},{href:\"https://www.nomadproject.io/docs/drivers/docker#allow_privileged\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"allow_privileged\")),`\nset to `,mdx(\"inlineCode\",{parentName:\"li\"},\"true\"),\".\")),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"You can set additional constraints with the \",mdx(\"inlineCode\",{parentName:\"p\"},\"constraints\"),` variable,\nwhich takes a list of objects with the following fields:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"attribute\"),` (string) - Specifies the name or reference of the\nattribute to examine for the constraint.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"operator\"),` (string) - Specifies the comparison operator. The\nordering is compared lexically.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"value\"),` (string) - Specifies the value to compare the attribute\nagainst using the specified operation.`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Below is also an example of how to pass \",mdx(\"inlineCode\",{parentName:\"p\"},\"constraints\"),` to the CLI with\nwith the `,mdx(\"inlineCode\",{parentName:\"p\"},\"-var\"),\" argument.\"),mdx(\"pre\",e({},{className:\"language-bash\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-bash\"}),\"nomad-pack run -var \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),`'constraints=[{\"attribute\":\"$\\${meta.my_custom_value}\",\"operator\":\">\",\"value\":\"3\"}]'`),\" packs/ceph\",`\n`)),mdx(\"h4\",e({},{id:\"user-content-resources-object\",\"data-text-content\":\"resources Object\",className:\"g-type-display-5\"}),mdx(\"inlineCode\",{parentName:\"h4\"},\"resources\"),\" Object\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"cpu\"),` (number 256) - Specifies the CPU required to run this task in\nMHz.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"memory\"),\" (number 600) - Specifies the memory required in MB.\")))}MDXContent.isMDXComponent=!0;\n","scope":{}}},"__N_SSG":true}