{"pageProps":{"metadata":{"title":"External Data Source | Integrations"},"product":{"name":"Packer","slug":"packer","algoliaConfig":{"indexName":"product_PACKER","searchOnlyApiKey":"4e1ea7f4bf4335ac43d9f28463e42148"},"analyticsConfig":{"includedDomains":"packer.io www.packer.io","segmentWriteKey":"AjXdfmTTk1I9q9dfyePuDFHBrz1tCO3l"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Packer by HashiCorp","description":"Packer helps you create golden images for multiple platforms from a single source configuration.","image":"https://www.packer.io/packer-public/img/og-image.png","icon":[{"href":"/packer-public/_favicon.ico"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiDays","url":"https://hashicorp.com/conferences/hashidays","text":"One conference. Three cities.","linkText":"Find a city near you","expirationDate":"2024-06-14T00:00:00-08:00"},"version":"1.7.10","basePaths":["docs","guides","intro","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"guide","name":"Guides","path":"guides"}],"integrationsConfig":{"description":"A curated collection of official, partner, and community Packer Integrations."}},"integration":{"id":"3ec57242-b5d9-4243-bee9-89fc857187ce","slug":"external","name":"External","description":"The External plugin is able to communicate with external commands.","license_type":null,"license_url":null,"external_only":false,"external_url":null,"tier":"community","repo_url":"https://github.com/joomcode/packer-plugin-external","subdirectory":"/.web-docs","created_at":"2024-05-30T19:25:25.625Z","updated_at":"2024-06-03T10:55:59.912Z","hide_versions":false,"organization":{"id":"b9966ae5-99a1-41ab-9590-c54fae9203e2","slug":"joomcode","created_at":"2023-08-14T20:21:44.651Z","updated_at":"2023-08-14T20:21:44.651Z"},"product":{"id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","slug":"packer","name":"Packer","created_at":"2022-11-09T22:56:29.896Z","updated_at":"2022-11-09T22:56:29.896Z"},"versions":["0.0.3"],"components":[{"id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","slug":"data-source","name":"Data Source","plural_name":"Data Sources"},{"id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","slug":"data-source","name":"Data Source","plural_name":"Data Sources"}],"flags":[],"integration_type":null},"activeRelease":{"id":"c54e86a8-585f-40d1-ad93-42ed36910ec8","integration_id":"3ec57242-b5d9-4243-bee9-89fc857187ce","version":"0.0.3","readme":"The External plugin is able to communicate with external commands.\n\n### Installation\n\nTo install this plugin, copy and paste this code into your Packer configuration, then run [`packer init`](https://www.packer.io/docs/commands/init).\n\n```hcl\npacker {\n  required_plugins {\n    external = {\n      version = \"> 0.0.2\"\n      source  = \"github.com/joomcode/external\"\n    }\n  }\n}\n```\n\nAlternatively, you can use `packer plugins install` to manage installation of this plugin.\n\n```sh\n$ packer plugins install github.com/joomcode/external\n```\n\n### Components\n\n#### Data Sources\n- [external](/packer/integrations/joomcode/external/latest/components/data-source/external) - Communicate with external commands\n  using JSON protocol.\n- [external-raw](/packer/integrations/joomcode/external/latest/components/data-source/raw) - Communicate with external commands\n  using plaintext protocol.\n\n","created_at":"2024-06-03T10:56:01.287Z","updated_at":"2024-06-03T10:56:01.287Z","components":[{"id":"1810850b-e0eb-4600-9772-01ec94eca114","integration_release_id":"c54e86a8-585f-40d1-ad93-42ed36910ec8","component_id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","readme":"Type: `external`\n\nThe `external` data source allows an external program implementing a specific\nprotocol (defined below) to act as a data source, exposing arbitrary\ndata for use elsewhere in the Packer configuration.\n\n~> **Warning** This mechanism is provided as an \"escape hatch\" for exceptional\nsituations where a first-class Packer provider is not more appropriate.\nIts capabilities are limited in comparison to a true data source, and\nimplementing a data source via an external program is likely to hurt the\nportability of your Packer configuration by creating dependencies on\nexternal programs and libraries that may not be available (or may need to\nbe used differently) on different operating systems.\n\n## Example Usage\n```hcl\ndata \"external\" \"example\" {\n  program = [\"jq\", \"{ \\\"foo\\\": .key1 }\"]\n  query = {\n    key1 = \"val1\"\n  }\n}\n\nlocals {\n  result = data.external.example.result\n}\n\nsource \"null\" \"example\" {\n  communicator = \"none\"\n}\n\nbuild {\n  sources = [\"source.null.example\"]\n\n  provisioner \"shell-local\" {\n    inline = [\n      \"echo ${local.result[\"foo\"]} == val1\",\n    ]\n  }\n}\n```\n\n## External Program Protocol\n\nThe external program described by the `program` attribute must implement a\nspecific protocol for interacting with Packer, as follows.\n\nThe program must read all the data passed to it on `stdin`, and parse\nit as a JSON object. The JSON object contains the contents of the `query`\nargument and its values will always be strings.\n\nThe program must then produce a valid JSON object on `stdout`, which will\nbe used to populate the `result` attribute exported to the rest of the\nPacker configuration. This JSON object must again have all of its\nvalues as strings. On successful completion it must exit with status zero.\n\nIf the program encounters an error and is unable to produce a result, it\nmust print a human-readable error message (ideally a single line) to `stderr`\nand exit with a non-zero status. Any data on `stdout` is ignored if the\nprogram returns a non-zero status.\n\nAll environment variables visible to the Packer process are passed through\nto the child program.\n\n## Argument Reference\n\n### Required\n\n- `command` ([]string) - A list of strings, whose first element is the program\n  to run and whose subsequent elements are optional command line arguments\n  to the program. Packer does not execute the program through a shell, so\n  it is not necessary to escape shell metacharacters nor add quotes around\n  arguments containing spaces.\n\n### Optional\n\n- `working_dir` (string) - Working directory of the program.\n  If not supplied, the program will run in the current directory.\n- `query` (map[string]string) - A map of string values to pass to the external program\n  as the query arguments. If not supplied, the program will receive an empty\n  object as its input.\n\n### Output\n\n- `result` (map[string]string) - A map of string values returned from the external program.\n\n\n## Processing JSON in shell scripts\n\nSince the external data source protocol uses JSON, it is recommended to use\nthe utility [`jq`](https://stedolan.github.io/jq/) to translate to and from\nJSON in a robust way when implementing a data source in a shell scripting\nlanguage.\n\nThe following example shows some input/output boilerplate code for a\ndata source implemented in bash:\n\n```bash\n#!/bin/bash\n# Exit if any of the intermediate steps fail\nset -e\n# Extract \"foo\" and \"baz\" arguments from the input into\n# FOO and BAZ shell variables.\n# jq will ensure that the values are properly quoted\n# and escaped for consumption by the shell.\neval \"$(jq -r '@sh \"FOO=\\(.foo) BAZ=\\(.baz)\"')\"\n# Placeholder for whatever data-fetching logic your script implements\nFOOBAZ=\"$FOO $BAZ\"\n# Safely produce a JSON object containing the result value.\n# jq will ensure that the value is properly quoted\n# and escaped to produce a valid JSON string.\njq -n --arg foobaz \"$FOOBAZ\" '{\"foobaz\":$foobaz}'\n```\n","created_at":"2024-06-03T10:56:02.993Z","updated_at":"2024-06-03T10:56:02.993Z","name":"External","slug":"external","component":{"id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","slug":"data-source","name":"Data Source","plural_name":"Data Sources","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.255Z","updated_at":"2022-11-09T22:56:31.255Z"},"variable_groups":[]},{"id":"aa56bee7-6a03-44d5-be56-703f27d1f19d","integration_release_id":"c54e86a8-585f-40d1-ad93-42ed36910ec8","component_id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","readme":"Type: `external-raw`\n\nThe `external-raw` data source allows an external program to act as a data source,\nexposing arbitrary data for use elsewhere in the Packer configuration.\n\n~> **Warning** This mechanism is provided as an \"escape hatch\" for exceptional\nsituations where a first-class Packer provider is not more appropriate.\nIts capabilities are limited in comparison to a true data source, and\nimplementing a data source via an external program is likely to hurt the\nportability of your Packer configuration by creating dependencies on\nexternal programs and libraries that may not be available (or may need to\nbe used differently) on different operating systems.\n\n## Example Usage\n```hcl\ndata \"external-raw\" \"example\" {\n  program = [\"rev\"]\n  query = \"hello\"\n}\n\nlocals {\n  result = data.external-raw.example.result\n}\n\nsource \"null\" \"example\" {\n  communicator = \"none\"\n}\n\nbuild {\n  sources = [\"source.null.example\"]\n\n  provisioner \"shell-local\" {\n    inline = [\n      \"echo ${trimspace(local.result)} == olleh\",\n    ]\n  }\n}\n```\n\n## External Program Protocol\n\nThe protocol is similar to the one used by the\n[external](/packer/integrations/joomcode/external/latest/components/data-source/external) data source.\nHowever, query and result are plaintext strings instead of JSON objects.\nRefer to the [external](/packer/integrations/joomcode/external/latest/components/data-source/external) doc\nfor more details.\n\n`external-raw` should be used over `external` in cases where the external program\ndoes not support JSON input and/or output.\n\n## Argument Reference\n\n### Required\n\n- `command` ([]string) - A list of strings, whose first element is the program\n  to run and whose subsequent elements are optional command line arguments\n  to the program. Packer does not execute the program through a shell, so\n  it is not necessary to escape shell metacharacters nor add quotes around\n  arguments containing spaces.\n\n### Optional\n\n- `working_dir` (string) - Working directory of the program.\n  If not supplied, the program will run in the current directory.\n- `query` (string) - An input to pass to the external program.\n  If not supplied, the program will not receive anything on standard input.\n\n### Output\n\n- `result` (string) - The output returned from the external program.\n","created_at":"2024-06-03T10:56:02.636Z","updated_at":"2024-06-03T10:56:02.636Z","name":"External Raw","slug":"raw","component":{"id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","slug":"data-source","name":"Data Source","plural_name":"Data Sources","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.255Z","updated_at":"2022-11-09T22:56:31.255Z"},"variable_groups":[]}]},"component":{"id":"1810850b-e0eb-4600-9772-01ec94eca114","integration_release_id":"c54e86a8-585f-40d1-ad93-42ed36910ec8","component_id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","readme":"Type: `external`\n\nThe `external` data source allows an external program implementing a specific\nprotocol (defined below) to act as a data source, exposing arbitrary\ndata for use elsewhere in the Packer configuration.\n\n~> **Warning** This mechanism is provided as an \"escape hatch\" for exceptional\nsituations where a first-class Packer provider is not more appropriate.\nIts capabilities are limited in comparison to a true data source, and\nimplementing a data source via an external program is likely to hurt the\nportability of your Packer configuration by creating dependencies on\nexternal programs and libraries that may not be available (or may need to\nbe used differently) on different operating systems.\n\n## Example Usage\n```hcl\ndata \"external\" \"example\" {\n  program = [\"jq\", \"{ \\\"foo\\\": .key1 }\"]\n  query = {\n    key1 = \"val1\"\n  }\n}\n\nlocals {\n  result = data.external.example.result\n}\n\nsource \"null\" \"example\" {\n  communicator = \"none\"\n}\n\nbuild {\n  sources = [\"source.null.example\"]\n\n  provisioner \"shell-local\" {\n    inline = [\n      \"echo ${local.result[\"foo\"]} == val1\",\n    ]\n  }\n}\n```\n\n## External Program Protocol\n\nThe external program described by the `program` attribute must implement a\nspecific protocol for interacting with Packer, as follows.\n\nThe program must read all the data passed to it on `stdin`, and parse\nit as a JSON object. The JSON object contains the contents of the `query`\nargument and its values will always be strings.\n\nThe program must then produce a valid JSON object on `stdout`, which will\nbe used to populate the `result` attribute exported to the rest of the\nPacker configuration. This JSON object must again have all of its\nvalues as strings. On successful completion it must exit with status zero.\n\nIf the program encounters an error and is unable to produce a result, it\nmust print a human-readable error message (ideally a single line) to `stderr`\nand exit with a non-zero status. Any data on `stdout` is ignored if the\nprogram returns a non-zero status.\n\nAll environment variables visible to the Packer process are passed through\nto the child program.\n\n## Argument Reference\n\n### Required\n\n- `command` ([]string) - A list of strings, whose first element is the program\n  to run and whose subsequent elements are optional command line arguments\n  to the program. Packer does not execute the program through a shell, so\n  it is not necessary to escape shell metacharacters nor add quotes around\n  arguments containing spaces.\n\n### Optional\n\n- `working_dir` (string) - Working directory of the program.\n  If not supplied, the program will run in the current directory.\n- `query` (map[string]string) - A map of string values to pass to the external program\n  as the query arguments. If not supplied, the program will receive an empty\n  object as its input.\n\n### Output\n\n- `result` (map[string]string) - A map of string values returned from the external program.\n\n\n## Processing JSON in shell scripts\n\nSince the external data source protocol uses JSON, it is recommended to use\nthe utility [`jq`](https://stedolan.github.io/jq/) to translate to and from\nJSON in a robust way when implementing a data source in a shell scripting\nlanguage.\n\nThe following example shows some input/output boilerplate code for a\ndata source implemented in bash:\n\n```bash\n#!/bin/bash\n# Exit if any of the intermediate steps fail\nset -e\n# Extract \"foo\" and \"baz\" arguments from the input into\n# FOO and BAZ shell variables.\n# jq will ensure that the values are properly quoted\n# and escaped for consumption by the shell.\neval \"$(jq -r '@sh \"FOO=\\(.foo) BAZ=\\(.baz)\"')\"\n# Placeholder for whatever data-fetching logic your script implements\nFOOBAZ=\"$FOO $BAZ\"\n# Safely produce a JSON object containing the result value.\n# jq will ensure that the value is properly quoted\n# and escaped to produce a valid JSON string.\njq -n --arg foobaz \"$FOOBAZ\" '{\"foobaz\":$foobaz}'\n```\n","created_at":"2024-06-03T10:56:02.993Z","updated_at":"2024-06-03T10:56:02.993Z","name":"External","slug":"external","component":{"id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","slug":"data-source","name":"Data Source","plural_name":"Data Sources","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.255Z","updated_at":"2022-11-09T22:56:31.255Z"},"variable_groups":[]},"processedVariablesMarkdown":{},"anchorLinks":[{"id":"example-usage","level":2,"title":"Example Usage"},{"id":"external-program-protocol","level":2,"title":"External Program Protocol"},{"id":"argument-reference","level":2,"title":"Argument Reference"},{"id":"required","level":3,"title":"Required"},{"id":"optional","level":3,"title":"Optional"},{"id":"output","level":3,"title":"Output"},{"id":"processing-json-in-shell-scripts","level":2,"title":"Processing JSON in shell scripts"}],"serializedREADME":{"compiledSource":"const layoutProps={};const MDXLayout=\"wrapper\";function MDXContent({components,...props}){return mdx(MDXLayout,{...layoutProps,...props,components:components,mdxType:\"MDXLayout\"},mdx(\"p\",{\"className\":\"g-type-long-body\"},`Type: `,mdx(\"inlineCode\",{parentName:\"p\"},`external`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The `,mdx(\"inlineCode\",{parentName:\"p\"},`external`),` data source allows an external program implementing a specific\nprotocol (defined below) to act as a data source, exposing arbitrary\ndata for use elsewhere in the Packer configuration.`),mdx(\"div\",{\"className\":\"alert alert-warning g-type-body\"},mdx(\"p\",{parentName:\"div\",\"className\":\"g-type-long-body\"},``,mdx(\"strong\",{parentName:\"p\"},`Warning`),` This mechanism is provided as an \"escape hatch\" for exceptional\nsituations where a first-class Packer provider is not more appropriate.\nIts capabilities are limited in comparison to a true data source, and\nimplementing a data source via an external program is likely to hurt the\nportability of your Packer configuration by creating dependencies on\nexternal programs and libraries that may not be available (or may need to\nbe used differently) on different operating systems.`)),mdx(\"h2\",{\"id\":\"user-content-example-usage\",\"data-text-content\":\"Example Usage\",\"className\":\"g-type-display-3\"},`Example Usage`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`data`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"external\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  program `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"jq\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"{ \\\\\"foo\\\\\": .key1 }\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  query `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    key1 `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"val1\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`locals`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  result `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` data.external.example.result`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`source`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"null\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  communicator `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"none\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`build`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  sources `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"source.null.example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  provisioner`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"shell-local\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    inline `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`      \"echo `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`\\${`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`local`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`result[\"foo\"]`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`}`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` == val1\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    ]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"h2\",{\"id\":\"user-content-external-program-protocol\",\"data-text-content\":\"External Program Protocol\",\"className\":\"g-type-display-3\"},`External Program Protocol`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The external program described by the `,mdx(\"inlineCode\",{parentName:\"p\"},`program`),` attribute must implement a\nspecific protocol for interacting with Packer, as follows.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The program must read all the data passed to it on `,mdx(\"inlineCode\",{parentName:\"p\"},`stdin`),`, and parse\nit as a JSON object. The JSON object contains the contents of the `,mdx(\"inlineCode\",{parentName:\"p\"},`query`),`\nargument and its values will always be strings.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The program must then produce a valid JSON object on `,mdx(\"inlineCode\",{parentName:\"p\"},`stdout`),`, which will\nbe used to populate the `,mdx(\"inlineCode\",{parentName:\"p\"},`result`),` attribute exported to the rest of the\nPacker configuration. This JSON object must again have all of its\nvalues as strings. On successful completion it must exit with status zero.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`If the program encounters an error and is unable to produce a result, it\nmust print a human-readable error message (ideally a single line) to `,mdx(\"inlineCode\",{parentName:\"p\"},`stderr`),`\nand exit with a non-zero status. Any data on `,mdx(\"inlineCode\",{parentName:\"p\"},`stdout`),` is ignored if the\nprogram returns a non-zero status.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`All environment variables visible to the Packer process are passed through\nto the child program.`),mdx(\"h2\",{\"id\":\"user-content-argument-reference\",\"data-text-content\":\"Argument Reference\",\"className\":\"g-type-display-3\"},`Argument Reference`),mdx(\"h3\",{\"id\":\"user-content-required\",\"data-text-content\":\"Required\",\"className\":\"g-type-display-4\"},`Required`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`command`),` ([]string) - A list of strings, whose first element is the program\nto run and whose subsequent elements are optional command line arguments\nto the program. Packer does not execute the program through a shell, so\nit is not necessary to escape shell metacharacters nor add quotes around\narguments containing spaces.`)),mdx(\"h3\",{\"id\":\"user-content-optional\",\"data-text-content\":\"Optional\",\"className\":\"g-type-display-4\"},`Optional`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`working_dir`),` (string) - Working directory of the program.\nIf not supplied, the program will run in the current directory.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`query`),` (map`,`[string]`,`string) - A map of string values to pass to the external program\nas the query arguments. If not supplied, the program will receive an empty\nobject as its input.`)),mdx(\"h3\",{\"id\":\"user-content-output\",\"data-text-content\":\"Output\",\"className\":\"g-type-display-4\"},`Output`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`result`),` (map`,`[string]`,`string) - A map of string values returned from the external program.`)),mdx(\"h2\",{\"id\":\"user-content-processing-json-in-shell-scripts\",\"data-text-content\":\"Processing JSON in shell scripts\",\"className\":\"g-type-display-3\"},`Processing JSON in shell scripts`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Since the external data source protocol uses JSON, it is recommended to use\nthe utility `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://stedolan.github.io/jq/\"},mdx(\"inlineCode\",{parentName:\"a\"},`jq`)),` to translate to and from\nJSON in a robust way when implementing a data source in a shell scripting\nlanguage.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The following example shows some input/output boilerplate code for a\ndata source implemented in bash:`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`#!/bin/bash`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# Exit if any of the intermediate steps fail`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`set`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` -e`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# Extract \"foo\" and \"baz\" arguments from the input into`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# FOO and BAZ shell variables.`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# jq will ensure that the values are properly quoted`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# and escaped for consumption by the shell.`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`eval`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"$(`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`jq`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` -r '@sh \"FOO=\\\\(.foo) BAZ=\\\\(.baz)\"')\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# Placeholder for whatever data-fetching logic your script implements`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`FOOBAZ`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"$FOO $BAZ\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# Safely produce a JSON object containing the result value.`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# jq will ensure that the value is properly quoted`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# and escaped to produce a valid JSON string.`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`jq`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` -n`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` --arg`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` foobaz`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"$FOOBAZ\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` '{\"foobaz\":$foobaz}'`)),`\n`)))};MDXContent.isMDXComponent=true;","scope":{}},"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Packer","url":"/packer"},{"title":"Integrations","url":"/packer/integrations"},{"title":"External","url":"/packer/integrations/joomcode/external","isCurrentPage":false},{"title":"v0.0.3","url":"/packer/integrations/joomcode/external/v0.0.3","isCurrentPage":false},{"title":"Components"},{"title":"Data Source"},{"title":"External","url":"/packer/integrations/joomcode/external/latest/components/data-source/external","isCurrentPage":true}]},"__N_SSG":true}